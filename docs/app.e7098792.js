parcelRequire=function(e,r,n){var t="function"==typeof parcelRequire&&parcelRequire,i="function"==typeof require&&require;function u(n,o){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!o&&f)return f(n,!0);if(t)return t(n,!0);if(i&&"string"==typeof n)return i(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}a.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,a,l,l.exports)}return r[n].exports;function a(e){return u(a.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=t;for(var o=0;o<n.length;o++)u(n[o]);return u}({13:[function(require,module,exports) {
var global = (1,eval)("this");
var e=(0,eval)("this");!function(){"use strict";function t(e,t,n,r,o,i){return{tag:e,key:t,attrs:n,children:r,text:o,dom:i,domSize:void 0,state:void 0,_state:void 0,events:void 0,instance:void 0,skip:!1}}t.normalize=function(e){return Array.isArray(e)?t("[",void 0,void 0,t.normalizeChildren(e),void 0,void 0):null!=e&&"object"!=typeof e?t("#",void 0,void 0,!1===e?"":e,void 0,void 0):e},t.normalizeChildren=function(e){for(var n=0;n<e.length;n++)e[n]=t.normalize(e[n]);return e};var n=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,r={},o={}.hasOwnProperty;function i(e){for(var t in e)if(o.call(e,t))return!1;return!0}function l(e){var l,a=arguments[1],u=2;if(null==e||"string"!=typeof e&&"function"!=typeof e&&"function"!=typeof e.view)throw Error("The selector must be either a string or a component.");if("string"==typeof e)var s=r[e]||function(e){for(var t,o="div",i=[],l={};t=n.exec(e);){var a=t[1],u=t[2];if(""===a&&""!==u)o=u;else if("#"===a)l.id=u;else if("."===a)i.push(u);else if("["===t[3][0]){var s=t[6];s&&(s=s.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===t[4]?i.push(s):l[t[4]]=""===s?s:s||!0}}return i.length>0&&(l.className=i.join(" ")),r[e]={tag:o,attrs:l}}(e);if(null==a?a={}:("object"!=typeof a||null!=a.tag||Array.isArray(a))&&(a={},u=1),arguments.length===u+1)l=arguments[u],Array.isArray(l)||(l=[l]);else for(l=[];u<arguments.length;)l.push(arguments[u++]);var f=t.normalizeChildren(l);return"string"==typeof e?function(e,n,r){var l,a,u=!1,s=n.className||n.class;if(!i(e.attrs)&&!i(n)){var f={};for(var c in n)o.call(n,c)&&(f[c]=n[c]);n=f}for(var c in e.attrs)o.call(e.attrs,c)&&(n[c]=e.attrs[c]);for(var c in void 0!==s&&(void 0!==n.class&&(n.class=void 0,n.className=s),null!=e.attrs.className&&(n.className=e.attrs.className+" "+s)),n)if(o.call(n,c)&&"key"!==c){u=!0;break}return Array.isArray(r)&&1===r.length&&null!=r[0]&&"#"===r[0].tag?a=r[0].children:l=r,t(e.tag,n.key,u?n:void 0,l,a)}(s,a,f):t(e,a.key,a,f)}l.trust=function(e){return null==e&&(e=""),t("<",void 0,void 0,e,void 0,void 0)},l.fragment=function(e,n){return t("[",e.key,e,t.normalizeChildren(n),void 0,void 0)};var a=l;if((u=function(e){if(!(this instanceof u))throw new Error("Promise must be called with `new`");if("function"!=typeof e)throw new TypeError("executor must be a function");var t=this,n=[],r=[],o=s(n,!0),i=s(r,!1),l=t._instance={resolvers:n,rejectors:r},a="function"==typeof setImmediate?setImmediate:setTimeout;function s(e,o){return function u(s){var c;try{if(!o||null==s||"object"!=typeof s&&"function"!=typeof s||"function"!=typeof(c=s.then))a(function(){o||0!==e.length||console.error("Possible unhandled promise rejection:",s);for(var t=0;t<e.length;t++)e[t](s);n.length=0,r.length=0,l.state=o,l.retry=function(){u(s)}});else{if(s===t)throw new TypeError("Promise can't be resolved w/ itself");f(c.bind(s))}}catch(e){i(e)}}}function f(e){var t=0;function n(e){return function(n){t++>0||e(n)}}var r=n(i);try{e(n(o),r)}catch(e){r(e)}}f(e)}).prototype.then=function(e,t){var n,r,o=this._instance;function i(e,t,i,l){t.push(function(t){if("function"!=typeof e)i(t);else try{n(e(t))}catch(e){r&&r(e)}}),"function"==typeof o.retry&&l===o.state&&o.retry()}var l=new u(function(e,t){n=e,r=t});return i(e,o.resolvers,n,!0),i(t,o.rejectors,r,!1),l},u.prototype.catch=function(e){return this.then(null,e)},u.resolve=function(e){return e instanceof u?e:new u(function(t){t(e)})},u.reject=function(e){return new u(function(t,n){n(e)})},u.all=function(e){return new u(function(t,n){var r=e.length,o=0,i=[];if(0===e.length)t([]);else for(var l=0;l<e.length;l++)!function(l){function a(e){o++,i[l]=e,o===r&&t(i)}null==e[l]||"object"!=typeof e[l]&&"function"!=typeof e[l]||"function"!=typeof e[l].then?a(e[l]):e[l].then(a,n)}(l)})},u.race=function(e){return new u(function(t,n){for(var r=0;r<e.length;r++)e[r].then(t,n)})},"undefined"!=typeof window){void 0===window.Promise&&(window.Promise=u);var u=window.Promise}else if(void 0!==e){void 0===e.Promise&&(e.Promise=u);u=e.Promise}var s=function(e){if("[object Object]"!==Object.prototype.toString.call(e))return"";var t=[];for(var n in e)r(n,e[n]);return t.join("&");function r(e,n){if(Array.isArray(n))for(var o=0;o<n.length;o++)r(e+"["+o+"]",n[o]);else if("[object Object]"===Object.prototype.toString.call(n))for(var o in n)r(e+"["+o+"]",n[o]);else t.push(encodeURIComponent(e)+(null!=n&&""!==n?"="+encodeURIComponent(n):""))}},f=new RegExp("^file://","i"),c=function(e,t){var n,r=0;function o(){var e=0;function t(){0==--e&&"function"==typeof n&&n()}return function n(r){var o=r.then;return r.then=function(){e++;var i=o.apply(r,arguments);return i.then(t,function(n){if(t(),0===e)throw n}),n(i)},r}}function i(e,t){if("string"==typeof e){var n=e;null==(e=t||{}).url&&(e.url=n)}return e}function l(e,t){if(null==t)return e;for(var n=e.match(/:[^\/]+/gi)||[],r=0;r<n.length;r++){var o=n[r].slice(1);null!=t[o]&&(e=e.replace(n[r],t[o]))}return e}function a(e,t){var n=s(t);return""!==n&&(e+=(e.indexOf("?")<0?"?":"&")+n),e}function u(e){try{return""!==e?JSON.parse(e):null}catch(t){throw new Error(e)}}function c(e){return e.responseText}function d(e,t){if("function"==typeof e){if(!Array.isArray(t))return new e(t);for(var n=0;n<t.length;n++)t[n]=new e(t[n])}return t}return{request:function(n,r){var s=o();n=i(n,r);var v=new t(function(t,r){null==n.method&&(n.method="GET"),n.method=n.method.toUpperCase();var o="GET"!==n.method&&"TRACE"!==n.method&&("boolean"!=typeof n.useBody||n.useBody);"function"!=typeof n.serialize&&(n.serialize="undefined"!=typeof FormData&&n.data instanceof FormData?function(e){return e}:JSON.stringify),"function"!=typeof n.deserialize&&(n.deserialize=u),"function"!=typeof n.extract&&(n.extract=c),n.url=l(n.url,n.data),o?n.data=n.serialize(n.data):n.url=a(n.url,n.data);var i=new e.XMLHttpRequest,s=!1,v=i.abort;for(var h in i.abort=function(){s=!0,v.call(i)},i.open(n.method,n.url,"boolean"!=typeof n.async||n.async,"string"==typeof n.user?n.user:void 0,"string"==typeof n.password?n.password:void 0),n.serialize!==JSON.stringify||!o||n.headers&&n.headers.hasOwnProperty("Content-Type")||i.setRequestHeader("Content-Type","application/json; charset=utf-8"),n.deserialize!==u||n.headers&&n.headers.hasOwnProperty("Accept")||i.setRequestHeader("Accept","application/json, text/*"),n.withCredentials&&(i.withCredentials=n.withCredentials),n.headers)({}).hasOwnProperty.call(n.headers,h)&&i.setRequestHeader(h,n.headers[h]);"function"==typeof n.config&&(i=n.config(i,n)||i),i.onreadystatechange=function(){if(!s&&4===i.readyState)try{var e=n.extract!==c?n.extract(i,n):n.deserialize(n.extract(i,n));if(i.status>=200&&i.status<300||304===i.status||f.test(n.url))t(d(n.type,e));else{var o=new Error(i.responseText);for(var l in e)o[l]=e[l];r(o)}}catch(e){r(e)}},o&&null!=n.data?i.send(n.data):i.send()});return!0===n.background?v:s(v)},jsonp:function(n,u){var s=o();n=i(n,u);var f=new t(function(t,o){var i=n.callbackName||"_mithril_"+Math.round(1e16*Math.random())+"_"+r++,u=e.document.createElement("script");e[i]=function(r){u.parentNode.removeChild(u),t(d(n.type,r)),delete e[i]},u.onerror=function(){u.parentNode.removeChild(u),o(new Error("JSONP request failed")),delete e[i]},null==n.data&&(n.data={}),n.url=l(n.url,n.data),n.data[n.callbackKey||"callback"]=i,u.src=a(n.url,n.data),e.document.documentElement.appendChild(u)});return!0===n.background?f:s(f)},setCompletionCallback:function(e){n=e}}}(window,u),d=function(e){var n,r=e.document,o=r.createDocumentFragment(),i={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function l(e){return e.attrs&&e.attrs.xmlns||i[e.tag]}function a(e,t,n,r,o,i,l){for(var a=n;a<r;a++){var s=t[a];null!=s&&u(e,s,o,l,i)}}function u(e,n,i,c,d){var v=n.tag;if("string"!=typeof v)return function(e,t,n,r,i){if(f(t,n),null!=t.instance){var l=u(e,t.instance,n,r,i);return t.dom=t.instance.dom,t.domSize=null!=t.dom?t.instance.domSize:0,m(e,l,i),l}return t.domSize=0,o}(e,n,i,c,d);switch(n.state={},null!=n.attrs&&S(n.attrs,n,i),v){case"#":return function(e,t,n){return t.dom=r.createTextNode(t.children),m(e,t.dom,n),t.dom}(e,n,d);case"<":return s(e,n,d);case"[":return function(e,t,n,o,i){var l=r.createDocumentFragment();if(null!=t.children){var u=t.children;a(l,u,0,u.length,n,null,o)}return t.dom=l.firstChild,t.domSize=l.childNodes.length,m(e,l,i),l}(e,n,i,c,d);default:return function(e,n,o,i,u){var s=n.tag,f=n.attrs,c=f&&f.is,d=(i=l(n)||i)?c?r.createElementNS(i,s,{is:c}):r.createElementNS(i,s):c?r.createElement(s,{is:c}):r.createElement(s);n.dom=d,null!=f&&function(e,t,n){for(var r in t)x(e,r,null,t[r],n)}(n,f,i);if(m(e,d,u),null!=n.attrs&&null!=n.attrs.contenteditable)g(n);else if(null!=n.text&&(""!==n.text?d.textContent=n.text:n.children=[t("#",void 0,void 0,n.text,void 0,void 0)]),null!=n.children){var v=n.children;a(d,v,0,v.length,o,null,i),function(e){var t=e.attrs;"select"===e.tag&&null!=t&&("value"in t&&x(e,"value",null,t.value,void 0),"selectedIndex"in t&&x(e,"selectedIndex",null,t.selectedIndex,void 0))}(n)}return d}(e,n,i,c,d)}}function s(e,t,n){var o={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"}[(t.children.match(/^\s*?<(\w+)/im)||[])[1]]||"div",i=r.createElement(o);i.innerHTML=t.children,t.dom=i.firstChild,t.domSize=i.childNodes.length;for(var l,a=r.createDocumentFragment();l=i.firstChild;)a.appendChild(l);return m(e,a,n),a}function f(e,n){var r;if("function"==typeof e.tag.view){if(e.state=Object.create(e.tag),null!=(r=e.state.view).$$reentrantLock$$)return o;r.$$reentrantLock$$=!0}else{if(e.state=void 0,null!=(r=e.tag).$$reentrantLock$$)return o;r.$$reentrantLock$$=!0,e.state=null!=e.tag.prototype&&"function"==typeof e.tag.prototype.view?new e.tag(e):e.tag(e)}if(e._state=e.state,null!=e.attrs&&S(e.attrs,e,n),S(e._state,e,n),e.instance=t.normalize(e._state.view.call(e.state,e)),e.instance===e)throw Error("A view cannot return the vnode it received as argument");r.$$reentrantLock$$=null}function c(e,t,n,r,o,i,l){if(t!==n&&(null!=t||null!=n))if(null==t)a(e,n,0,n.length,o,i,l);else if(null==n)y(t,0,t.length,n);else{if(t.length===n.length){for(var s=!1,f=0;f<n.length;f++)if(null!=n[f]&&null!=t[f]){s=null==n[f].key&&null==t[f].key;break}if(s){for(f=0;f<t.length;f++)t[f]!==n[f]&&(null==t[f]&&null!=n[f]?u(e,n[f],o,l,p(t,f+1,i)):null==n[f]?y(t,f,f+1,n):d(e,t[f],n[f],o,p(t,f+1,i),r,l));return}}if(r=r||function(e,t){if(null!=e.pool&&Math.abs(e.pool.length-t.length)<=Math.abs(e.length-t.length)){var n=e[0]&&e[0].children&&e[0].children.length||0,r=e.pool[0]&&e.pool[0].children&&e.pool[0].children.length||0,o=t[0]&&t[0].children&&t[0].children.length||0;if(Math.abs(r-o)<=Math.abs(n-o))return!0}return!1}(t,n)){var c=t.pool;t=t.concat(t.pool)}for(var g,w=0,b=0,x=t.length-1,k=n.length-1;x>=w&&k>=b;){if((S=t[w])!==(E=n[b])||r)if(null==S)w++;else if(null==E)b++;else if(S.key===E.key){var C=null!=c&&w>=t.length-c.length||null==c&&r;b++,d(e,S,E,o,p(t,++w,i),C,l),r&&S.tag===E.tag&&m(e,h(S),i)}else{if((S=t[x])!==E||r)if(null==S)x--;else if(null==E)b++;else{if(S.key!==E.key)break;C=null!=c&&x>=t.length-c.length||null==c&&r;d(e,S,E,o,p(t,x+1,i),C,l),(r||b<k)&&m(e,h(S),p(t,w,i)),x--,b++}else x--,b++}else w++,b++}for(;x>=w&&k>=b;){var S,E;if((S=t[x])!==(E=n[k])||r)if(null==S)x--;else if(null==E)k--;else if(S.key===E.key){C=null!=c&&x>=t.length-c.length||null==c&&r;d(e,S,E,o,p(t,x+1,i),C,l),r&&S.tag===E.tag&&m(e,h(S),i),null!=S.dom&&(i=S.dom),x--,k--}else{if(g||(g=v(t,x)),null!=E){var z=g[E.key];if(null!=z){var A=t[z];C=null!=c&&z>=t.length-c.length||null==c&&r;d(e,A,E,o,p(t,x+1,i),r,l),m(e,h(A),i),t[z].skip=!0,null!=A.dom&&(i=A.dom)}else{i=u(e,E,o,l,i)}}k--}else x--,k--;if(k<b)break}a(e,n,b,k+1,o,i,l),y(t,w,x+1,n)}}function d(e,n,r,o,i,a,v){var p=n.tag;if(p===r.tag){if(r.state=n.state,r._state=n._state,r.events=n.events,!a&&function(e,t){var n,r;null!=e.attrs&&"function"==typeof e.attrs.onbeforeupdate&&(n=e.attrs.onbeforeupdate.call(e.state,e,t));"string"!=typeof e.tag&&"function"==typeof e._state.onbeforeupdate&&(r=e._state.onbeforeupdate.call(e.state,e,t));if(!(void 0===n&&void 0===r||n||r))return e.dom=t.dom,e.domSize=t.domSize,e.instance=t.instance,!0;return!1}(r,n))return;if("string"==typeof p)switch(null!=r.attrs&&(a?(r.state={},S(r.attrs,r,o)):E(r.attrs,r,o)),p){case"#":!function(e,t){e.children.toString()!==t.children.toString()&&(e.dom.nodeValue=t.children);t.dom=e.dom}(n,r);break;case"<":!function(e,t,n,r){t.children!==n.children?(h(t),s(e,n,r)):(n.dom=t.dom,n.domSize=t.domSize)}(e,n,r,i);break;case"[":!function(e,t,n,r,o,i,l){c(e,t.children,n.children,r,o,i,l);var a=0,u=n.children;if(n.dom=null,null!=u){for(var s=0;s<u.length;s++){var f=u[s];null!=f&&null!=f.dom&&(null==n.dom&&(n.dom=f.dom),a+=f.domSize||1)}1!==a&&(n.domSize=a)}}(e,n,r,a,o,i,v);break;default:!function(e,n,r,o,i){var a=n.dom=e.dom;i=l(n)||i,"textarea"===n.tag&&(null==n.attrs&&(n.attrs={}),null!=n.text&&(n.attrs.value=n.text,n.text=void 0));(function(e,t,n,r){if(null!=n)for(var o in n)x(e,o,t&&t[o],n[o],r);if(null!=t)for(var o in t)null!=n&&o in n||("className"===o&&(o="class"),"o"!==o[0]||"n"!==o[1]||k(o)?"key"!==o&&e.dom.removeAttribute(o):C(e,o,void 0))})(n,e.attrs,n.attrs,i),null!=n.attrs&&null!=n.attrs.contenteditable?g(n):null!=e.text&&null!=n.text&&""!==n.text?e.text.toString()!==n.text.toString()&&(e.dom.firstChild.nodeValue=n.text):(null!=e.text&&(e.children=[t("#",void 0,void 0,e.text,void 0,e.dom.firstChild)]),null!=n.text&&(n.children=[t("#",void 0,void 0,n.text,void 0,void 0)]),c(a,e.children,n.children,r,o,null,i))}(n,r,a,o,v)}else!function(e,n,r,o,i,l,a){if(l)f(r,o);else{if(r.instance=t.normalize(r._state.view.call(r.state,r)),r.instance===r)throw Error("A view cannot return the vnode it received as argument");null!=r.attrs&&E(r.attrs,r,o),E(r._state,r,o)}null!=r.instance?(null==n.instance?u(e,r.instance,o,a,i):d(e,n.instance,r.instance,o,i,l,a),r.dom=r.instance.dom,r.domSize=r.instance.domSize):null!=n.instance?(w(n.instance,null),r.dom=void 0,r.domSize=0):(r.dom=n.dom,r.domSize=n.domSize)}(e,n,r,o,i,a,v)}else w(n,null),u(e,r,o,v,i)}function v(e,t){var n={},r=0;for(r=0;r<t;r++){var o=e[r];if(null!=o){var i=o.key;null!=i&&(n[i]=r)}}return n}function h(e){var t=e.domSize;if(null!=t||null==e.dom){var n=r.createDocumentFragment();if(t>0){for(var o=e.dom;--t;)n.appendChild(o.nextSibling);n.insertBefore(o,n.firstChild)}return n}return e.dom}function p(e,t,n){for(;t<e.length;t++)if(null!=e[t]&&null!=e[t].dom)return e[t].dom;return n}function m(e,t,n){n&&n.parentNode?e.insertBefore(t,n):e.appendChild(t)}function g(e){var t=e.children;if(null!=t&&1===t.length&&"<"===t[0].tag){var n=t[0].children;e.dom.innerHTML!==n&&(e.dom.innerHTML=n)}else if(null!=e.text||null!=t&&0!==t.length)throw new Error("Child node of a contenteditable must be trusted")}function y(e,t,n,r){for(var o=t;o<n;o++){var i=e[o];null!=i&&(i.skip?i.skip=!1:w(i,r))}}function w(e,t){var n,r=1,o=0;e.attrs&&"function"==typeof e.attrs.onbeforeremove&&(null!=(n=e.attrs.onbeforeremove.call(e.state,e))&&"function"==typeof n.then&&(r++,n.then(i,i)));"string"!=typeof e.tag&&"function"==typeof e._state.onbeforeremove&&(null!=(n=e._state.onbeforeremove.call(e.state,e))&&"function"==typeof n.then&&(r++,n.then(i,i)));function i(){if(++o===r&&(function e(t){t.attrs&&"function"==typeof t.attrs.onremove&&t.attrs.onremove.call(t.state,t);if("string"!=typeof t.tag)"function"==typeof t._state.onremove&&t._state.onremove.call(t.state,t),null!=t.instance&&e(t.instance);else{var n=t.children;if(Array.isArray(n))for(var r=0;r<n.length;r++){var o=n[r];null!=o&&e(o)}}}(e),e.dom)){var n=e.domSize||1;if(n>1)for(var i=e.dom;--n;)b(i.nextSibling);b(e.dom),null==t||null!=e.domSize||null!=(l=e.attrs)&&(l.oncreate||l.onupdate||l.onbeforeremove||l.onremove)||"string"!=typeof e.tag||(t.pool?t.pool.push(e):t.pool=[e])}var l}i()}function b(e){var t=e.parentNode;null!=t&&t.removeChild(e)}function x(e,t,n,o,i){var l=e.dom;if("key"!==t&&"is"!==t&&(n!==o||function(e,t){return"value"===t||"checked"===t||"selectedIndex"===t||"selected"===t&&e.dom===r.activeElement}(e,t)||"object"==typeof o)&&void 0!==o&&!k(t)){var a,u=t.indexOf(":");if(u>-1&&"xlink"===t.substr(0,u))l.setAttributeNS("http://www.w3.org/1999/xlink",t.slice(u+1),o);else if("o"===t[0]&&"n"===t[1]&&"function"==typeof o)C(e,t,o);else if("style"===t)!function(e,t,n){t===n&&(e.style.cssText="",t=null);if(null==n)e.style.cssText="";else if("string"==typeof n)e.style.cssText=n;else{for(var r in"string"==typeof t&&(e.style.cssText=""),n)e.style[r]=n[r];if(null!=t&&"string"!=typeof t)for(var r in t)r in n||(e.style[r]="")}}(l,n,o);else if(t in l&&("href"!==(a=t)&&"list"!==a&&"form"!==a&&"width"!==a&&"height"!==a)&&void 0===i&&!function(e){return e.attrs.is||e.tag.indexOf("-")>-1}(e)){if("value"===t){var s=""+o;if(("input"===e.tag||"textarea"===e.tag)&&e.dom.value===s&&e.dom===r.activeElement)return;if("select"===e.tag)if(null===o){if(-1===e.dom.selectedIndex&&e.dom===r.activeElement)return}else if(null!==n&&e.dom.value===s&&e.dom===r.activeElement)return;if("option"===e.tag&&null!=n&&e.dom.value===s)return}if("input"===e.tag&&"type"===t)return void l.setAttribute(t,o);l[t]=o}else"boolean"==typeof o?o?l.setAttribute(t,""):l.removeAttribute(t):l.setAttribute("className"===t?"class":t,o)}}function k(e){return"oninit"===e||"oncreate"===e||"onupdate"===e||"onremove"===e||"onbeforeremove"===e||"onbeforeupdate"===e}function C(e,t,r){var o=e.dom,i="function"!=typeof n?r:function(e){var t=r.call(o,e);return n.call(o,e),t};if(t in o)o[t]="function"==typeof r?i:null;else{var l=t.slice(2);if(void 0===e.events&&(e.events={}),e.events[t]===i)return;null!=e.events[t]&&o.removeEventListener(l,e.events[t],!1),"function"==typeof r&&(e.events[t]=i,o.addEventListener(l,e.events[t],!1))}}function S(e,t,n){"function"==typeof e.oninit&&e.oninit.call(t.state,t),"function"==typeof e.oncreate&&n.push(e.oncreate.bind(t.state,t))}function E(e,t,n){"function"==typeof e.onupdate&&n.push(e.onupdate.bind(t.state,t))}return{render:function(e,n){if(!e)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var o=[],i=r.activeElement,l=e.namespaceURI;null==e.vnodes&&(e.textContent=""),Array.isArray(n)||(n=[n]),c(e,e.vnodes,t.normalizeChildren(n),!1,o,null,"http://www.w3.org/1999/xhtml"===l?void 0:l),e.vnodes=n,null!=i&&r.activeElement!==i&&i.focus();for(var a=0;a<o.length;a++)o[a]()},setEventCallback:function(e){return n=e}}};var v=function(e){var t=d(e);t.setEventCallback(function(e){!1===e.redraw?e.redraw=void 0:o()});var n=[];function r(e){var t=n.indexOf(e);t>-1&&n.splice(t,2)}function o(){for(var e=1;e<n.length;e+=2)n[e]()}return{subscribe:function(e,t){r(e),n.push(e,function(e){var t=0,n=null,r="function"==typeof requestAnimationFrame?requestAnimationFrame:setTimeout;return function(){var o=Date.now();0===t||o-t>=16?(t=o,e()):null===n&&(n=r(function(){n=null,e(),t=Date.now()},16-(o-t)))}}(t))},unsubscribe:r,redraw:o,render:t.render}}(window);c.setCompletionCallback(v.redraw);var h;a.mount=(h=v,function(e,n){if(null===n)return h.render(e,[]),void h.unsubscribe(e);if(null==n.view&&"function"!=typeof n)throw new Error("m.mount(element, component) expects a component, not a vnode");h.subscribe(e,function(){h.render(e,t(n))}),h.redraw()});var p=u,m=function(e){if(""===e||null==e)return{};"?"===e.charAt(0)&&(e=e.slice(1));for(var t=e.split("&"),n={},r={},o=0;o<t.length;o++){var i=t[o].split("="),l=decodeURIComponent(i[0]),a=2===i.length?decodeURIComponent(i[1]):"";"true"===a?a=!0:"false"===a&&(a=!1);var u=l.split(/\]\[?|\[/),s=n;l.indexOf("[")>-1&&u.pop();for(var f=0;f<u.length;f++){var c=u[f],d=u[f+1],v=""==d||!isNaN(parseInt(d,10)),h=f===u.length-1;if(""===c)null==r[l=u.slice(0,f).join()]&&(r[l]=0),c=r[l]++;null==s[c]&&(s[c]=h?a:v?[]:{}),s=s[c]}}return n},g=function(e){var t,n="function"==typeof e.history.pushState,r="function"==typeof setImmediate?setImmediate:setTimeout;function o(t){var n=e.location[t].replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent);return"pathname"===t&&"/"!==n[0]&&(n="/"+n),n}function i(e,t,n){var r=e.indexOf("?"),o=e.indexOf("#"),i=r>-1?r:o>-1?o:e.length;if(r>-1){var l=o>-1?o:e.length,a=m(e.slice(r+1,l));for(var u in a)t[u]=a[u]}if(o>-1){var s=m(e.slice(o+1));for(var u in s)n[u]=s[u]}return e.slice(0,i)}var l={prefix:"#!",getPath:function(){switch(l.prefix.charAt(0)){case"#":return o("hash").slice(l.prefix.length);case"?":return o("search").slice(l.prefix.length)+o("hash");default:return o("pathname").slice(l.prefix.length)+o("search")+o("hash")}},setPath:function(t,r,o){var a={},u={};if(t=i(t,a,u),null!=r){for(var f in r)a[f]=r[f];t=t.replace(/:([^\/]+)/g,function(e,t){return delete a[t],r[t]})}var c=s(a);c&&(t+="?"+c);var d=s(u);if(d&&(t+="#"+d),n){var v=o?o.state:null,h=o?o.title:null;e.onpopstate(),o&&o.replace?e.history.replaceState(v,h,l.prefix+t):e.history.pushState(v,h,l.prefix+t)}else e.location.href=l.prefix+t}};return l.defineRoutes=function(o,a,u){function s(){var t=l.getPath(),n={},r=i(t,n,n),s=e.history.state;if(null!=s)for(var f in s)n[f]=s[f];for(var c in o){var d=new RegExp("^"+c.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"/?$");if(d.test(r))return void r.replace(d,function(){for(var e=c.match(/:[^\/]+/g)||[],r=[].slice.call(arguments,1,-2),i=0;i<e.length;i++)n[e[i].replace(/:|\./g,"")]=decodeURIComponent(r[i]);a(o[c],n,t,c)})}u(t,n)}var f;n?e.onpopstate=(f=s,function(){null==t&&(t=r(function(){t=null,f()}))}):"#"===l.prefix.charAt(0)&&(e.onhashchange=s),s()},l};a.route=function(e,n){var r,o,i,l,a,u=g(e),s=function(e,s,f){if(null==e)throw new Error("Ensure the DOM element that was passed to `m.route` is not undefined");var c=function(){null!=r&&n.render(e,r(t(o,i.key,i)))},d=function(e){if(e===s)throw new Error("Could not resolve default route "+s);u.setPath(s,null,{replace:!0})};u.defineRoutes(f,function(e,t,n){var u=a=function(e,s){u===a&&(o=null==s||"function"!=typeof s.view&&"function"!=typeof s?"div":s,i=t,l=n,a=null,r=(e.render||function(e){return e}).bind(e),c())};e.view||"function"==typeof e?u({},e):e.onmatch?p.resolve(e.onmatch(t,n)).then(function(t){u(e,t)},d):u(e,"div")},d),n.subscribe(e,c)};return s.set=function(e,t,n){null!=a&&((n=n||{}).replace=!0),a=null,u.setPath(e,t,n)},s.get=function(){return l},s.prefix=function(e){u.prefix=e},s.link=function(e){e.dom.setAttribute("href",u.prefix+e.attrs.href),e.dom.onclick=function(e){if(!(e.ctrlKey||e.metaKey||e.shiftKey||2===e.which)){e.preventDefault(),e.redraw=!1;var t=this.getAttribute("href");0===t.indexOf(u.prefix)&&(t=t.slice(u.prefix.length)),s.set(t,void 0,void 0)}}},s.param=function(e){return void 0!==i&&void 0!==e?i[e]:i},s}(window,v),a.withAttr=function(e,t,n){return function(r){t.call(n||this,e in r.currentTarget?r.currentTarget[e]:r.currentTarget.getAttribute(e))}};var y=d(window);a.render=y.render,a.redraw=v.redraw,a.request=c.request,a.jsonp=c.jsonp,a.parseQueryString=m,a.buildQueryString=s,a.version="1.1.6",a.vnode=t,"undefined"!=typeof module?module.exports=a:window.m=a}();
},{}],14:[function(require,module,exports) {

},{}],136:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o};function e(o,e){return o(e={exports:{}},e.exports),e.exports}var t=e(function(o,e){function t(o){var e=[];for(var t in o)e.push(t);return e}(o.exports="function"==typeof Object.keys?Object.keys:t).shim=t}),r=t.shim,n=e(function(e,t){var r="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function n(o){return"[object Arguments]"==Object.prototype.toString.call(o)}function i(e){return e&&"object"==(void 0===e?"undefined":o(e))&&"number"==typeof e.length&&Object.prototype.hasOwnProperty.call(e,"callee")&&!Object.prototype.propertyIsEnumerable.call(e,"callee")||!1}(t=e.exports=r?n:i).supported=n,t.unsupported=i}),i=n.supported,c=n.unsupported,a=e(function(e){var r=Array.prototype.slice,i=e.exports=function(e,s,l){return l||(l={}),e===s||(e instanceof Date&&s instanceof Date?e.getTime()===s.getTime():!e||!s||"object"!=(void 0===e?"undefined":o(e))&&"object"!=(void 0===s?"undefined":o(s))?l.strict?e===s:e==s:function(e,s,l){var d,u;if(c(e)||c(s))return!1;if(e.prototype!==s.prototype)return!1;if(n(e))return!!n(s)&&(e=r.call(e),s=r.call(s),i(e,s,l));if(a(e)){if(!a(s))return!1;if(e.length!==s.length)return!1;for(d=0;d<e.length;d++)if(e[d]!==s[d])return!1;return!0}try{var p=t(e),f=t(s)}catch(e){return!1}if(p.length!=f.length)return!1;for(p.sort(),f.sort(),d=p.length-1;d>=0;d--)if(p[d]!=f[d])return!1;for(d=p.length-1;d>=0;d--)if(u=p[d],!i(e[u],s[u],l))return!1;return(void 0===e?"undefined":o(e))==(void 0===s?"undefined":o(s))}(e,s,l))};function c(o){return null===o||void 0===o}function a(e){return!(!e||"object"!=(void 0===e?"undefined":o(e))||"number"!=typeof e.length||"function"!=typeof e.copy||"function"!=typeof e.slice||e.length>0&&"number"!=typeof e[0])}}),s={SENTE:0,GOTE:1},l={NONE:0,FU:1,KY:2,KE:3,GI:4,KI:5,KA:6,HI:7,OU:8,TO:9,NY:10,NK:11,NG:12,UM:13,RY:14},d={HIRATE:"HIRATE",KYO:"KY",KAKU:"KA",HISHA:"HI",HIKYO:"HIKY",NI:"2",YON:"4",ROKU:"6",HACHI:"8",OTHER:"OTHER"},u={POS:"pos",DIR:"dir"},p=function(){function o(){}return o.komaAtoi=function(o){var e=0;switch(o){case"FU":e=l.FU;break;case"KY":e=l.KY;break;case"KE":e=l.KE;break;case"GI":e=l.GI;break;case"KI":e=l.KI;break;case"KA":e=l.KA;break;case"HI":e=l.HI;break;case"OU":e=l.OU;break;case"TO":e=l.TO;break;case"NY":e=l.NY;break;case"NK":e=l.NK;break;case"NG":e=l.NG;break;case"UM":e=l.UM;break;case"RY":e=l.RY;break;default:e=l.NONE}return e},o.getKanji=function(o){return this.komaData[o].name},o.getJKFString=function(o){return this.komaData[o].boardName},o.getPromote=function(o){return this.komaData[o].toPromote===l.NONE?null:this.komaData[o].toPromote},o.getOrigin=function(o){return this.komaData[o].fromPromote===l.NONE?o:this.komaData[o].fromPromote},o.getMoves=function(o){return this.komaData[o].moves},o.komaItoa=function(o){return this.komaData[o].boardName},o.komaochiTypes=["香落ち","角落ち","飛車落ち","飛香落ち","二枚落ち","四枚落ち","六枚落ち","八枚落ち"],o.initBoards={HIRATE:[[{color:1,kind:"KY"},{color:1,kind:"KE"},{color:1,kind:"GI"},{color:1,kind:"KI"},{color:1,kind:"OU"},{color:1,kind:"KI"},{color:1,kind:"GI"},{color:1,kind:"KE"},{color:1,kind:"KY"}],[{},{color:1,kind:"HI"},{},{},{},{},{},{color:1,kind:"KA"},{}],[{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"}],[{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{}],[{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"}],[{},{color:0,kind:"KA"},{},{},{},{},{},{color:0,kind:"HI"},{}],[{color:0,kind:"KY"},{color:0,kind:"KE"},{color:0,kind:"GI"},{color:0,kind:"KI"},{color:0,kind:"OU"},{color:0,kind:"KI"},{color:0,kind:"GI"},{color:0,kind:"KE"},{color:0,kind:"KY"}]],KY:[[{color:1,kind:"KY"},{color:1,kind:"KE"},{color:1,kind:"GI"},{color:1,kind:"KI"},{color:1,kind:"OU"},{color:1,kind:"KI"},{color:1,kind:"GI"},{color:1,kind:"KE"},{color:1,kind:"KY"}],[{},{color:1,kind:"HI"},{},{},{},{},{},{color:1,kind:"KA"},{}],[{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"}],[{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{}],[{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"}],[{},{color:0,kind:"KA"},{},{},{},{},{},{color:0,kind:"HI"},{}],[{},{color:0,kind:"KE"},{color:0,kind:"GI"},{color:0,kind:"KI"},{color:0,kind:"OU"},{color:0,kind:"KI"},{color:0,kind:"GI"},{color:0,kind:"KE"},{color:0,kind:"KY"}]],KA:[[{color:1,kind:"KY"},{color:1,kind:"KE"},{color:1,kind:"GI"},{color:1,kind:"KI"},{color:1,kind:"OU"},{color:1,kind:"KI"},{color:1,kind:"GI"},{color:1,kind:"KE"},{color:1,kind:"KY"}],[{},{color:1,kind:"HI"},{},{},{},{},{},{color:1,kind:"KA"},{}],[{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"}],[{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{}],[{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"}],[{},{},{},{},{},{},{},{color:0,kind:"HI"},{}],[{color:0,kind:"KY"},{color:0,kind:"KE"},{color:0,kind:"GI"},{color:0,kind:"KI"},{color:0,kind:"OU"},{color:0,kind:"KI"},{color:0,kind:"GI"},{color:0,kind:"KE"},{color:0,kind:"KY"}]],HI:[[{color:1,kind:"KY"},{color:1,kind:"KE"},{color:1,kind:"GI"},{color:1,kind:"KI"},{color:1,kind:"OU"},{color:1,kind:"KI"},{color:1,kind:"GI"},{color:1,kind:"KE"},{color:1,kind:"KY"}],[{},{color:1,kind:"HI"},{},{},{},{},{},{color:1,kind:"KA"},{}],[{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"}],[{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{}],[{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"}],[{},{color:0,kind:"KA"},{},{},{},{},{},{},{}],[{color:0,kind:"KY"},{color:0,kind:"KE"},{color:0,kind:"GI"},{color:0,kind:"KI"},{color:0,kind:"OU"},{color:0,kind:"KI"},{color:0,kind:"GI"},{color:0,kind:"KE"},{color:0,kind:"KY"}]],HIKY:[[{color:1,kind:"KY"},{color:1,kind:"KE"},{color:1,kind:"GI"},{color:1,kind:"KI"},{color:1,kind:"OU"},{color:1,kind:"KI"},{color:1,kind:"GI"},{color:1,kind:"KE"},{color:1,kind:"KY"}],[{},{color:1,kind:"HI"},{},{},{},{},{},{color:1,kind:"KA"},{}],[{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"}],[{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{}],[{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"}],[{},{color:0,kind:"KA"},{},{},{},{},{},{},{}],[{},{color:0,kind:"KE"},{color:0,kind:"GI"},{color:0,kind:"KI"},{color:0,kind:"OU"},{color:0,kind:"KI"},{color:0,kind:"GI"},{color:0,kind:"KE"},{color:0,kind:"KY"}]],2:[[{color:1,kind:"KY"},{color:1,kind:"KE"},{color:1,kind:"GI"},{color:1,kind:"KI"},{color:1,kind:"OU"},{color:1,kind:"KI"},{color:1,kind:"GI"},{color:1,kind:"KE"},{color:1,kind:"KY"}],[{},{color:1,kind:"HI"},{},{},{},{},{},{color:1,kind:"KA"},{}],[{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"}],[{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{}],[{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"}],[{},{},{},{},{},{},{},{},{}],[{color:0,kind:"KY"},{color:0,kind:"KE"},{color:0,kind:"GI"},{color:0,kind:"KI"},{color:0,kind:"OU"},{color:0,kind:"KI"},{color:0,kind:"GI"},{color:0,kind:"KE"},{color:0,kind:"KY"}]],4:[[{color:1,kind:"KY"},{color:1,kind:"KE"},{color:1,kind:"GI"},{color:1,kind:"KI"},{color:1,kind:"OU"},{color:1,kind:"KI"},{color:1,kind:"GI"},{color:1,kind:"KE"},{color:1,kind:"KY"}],[{},{color:1,kind:"HI"},{},{},{},{},{},{color:1,kind:"KA"},{}],[{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"}],[{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{}],[{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"}],[{},{},{},{},{},{},{},{},{}],[{},{color:0,kind:"KE"},{color:0,kind:"GI"},{color:0,kind:"KI"},{color:0,kind:"OU"},{color:0,kind:"KI"},{color:0,kind:"GI"},{color:0,kind:"KE"},{}]],6:[[{color:1,kind:"KY"},{color:1,kind:"KE"},{color:1,kind:"GI"},{color:1,kind:"KI"},{color:1,kind:"OU"},{color:1,kind:"KI"},{color:1,kind:"GI"},{color:1,kind:"KE"},{color:1,kind:"KY"}],[{},{color:1,kind:"HI"},{},{},{},{},{},{color:1,kind:"KA"},{}],[{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"}],[{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{}],[{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"}],[{},{},{},{},{},{},{},{},{}],[{},{},{color:0,kind:"GI"},{color:0,kind:"KI"},{color:0,kind:"OU"},{color:0,kind:"KI"},{color:0,kind:"GI"},{},{}]],8:[[{color:1,kind:"KY"},{color:1,kind:"KE"},{color:1,kind:"GI"},{color:1,kind:"KI"},{color:1,kind:"OU"},{color:1,kind:"KI"},{color:1,kind:"GI"},{color:1,kind:"KE"},{color:1,kind:"KY"}],[{},{color:1,kind:"HI"},{},{},{},{},{},{color:1,kind:"KA"},{}],[{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"},{color:1,kind:"FU"}],[{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{},{}],[{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"},{color:0,kind:"FU"}],[{},{},{},{},{},{},{},{},{}],[{},{},{},{color:0,kind:"KI"},{color:0,kind:"OU"},{color:0,kind:"KI"},{},{},{}]]},o.komaData=[{name:"無",fullName:"駒無",boardName:"NO",moves:[],isPromote:!1,toPromote:l.NONE,fromPromote:l.NONE},{name:"歩",fullName:"歩兵",boardName:"FU",moves:[{type:u.POS,x:0,y:1}],isPromote:!1,toPromote:l.TO,fromPromote:l.NONE},{name:"香",fullName:"香車",boardName:"KY",moves:[{type:u.DIR,x:0,y:1}],isPromote:!1,toPromote:l.NY,fromPromote:l.NONE},{name:"桂",fullName:"桂馬",boardName:"KE",moves:[{type:u.POS,x:-1,y:2},{type:u.POS,x:1,y:2}],isPromote:!1,toPromote:l.NK,fromPromote:l.NONE},{name:"銀",fullName:"銀将",boardName:"GI",moves:[{type:u.POS,x:0,y:1},{type:u.POS,x:-1,y:1},{type:u.POS,x:1,y:1},{type:u.POS,x:-1,y:-1},{type:u.POS,x:1,y:-1}],isPromote:!1,toPromote:l.NG,fromPromote:l.NONE},{name:"金",fullName:"金将",boardName:"KI",moves:[{type:u.POS,x:-1,y:1},{type:u.POS,x:-1,y:0},{type:u.POS,x:0,y:1},{type:u.POS,x:0,y:-1},{type:u.POS,x:1,y:1},{type:u.POS,x:1,y:0}],isPromote:!1,toPromote:l.NONE,fromPromote:l.NONE},{name:"角",fullName:"角行",boardName:"KA",moves:[{type:u.DIR,x:-1,y:1},{type:u.DIR,x:1,y:1},{type:u.DIR,x:-1,y:-1},{type:u.DIR,x:1,y:-1}],isPromote:!1,toPromote:l.UM,fromPromote:l.NONE},{name:"飛",fullName:"飛車",boardName:"HI",moves:[{type:u.DIR,x:1,y:0},{type:u.DIR,x:0,y:1},{type:u.DIR,x:-1,y:0},{type:u.DIR,x:0,y:-1}],isPromote:!1,toPromote:l.RY,fromPromote:l.NONE},{name:"玉",fullName:"王将",boardName:"OU",moves:[{type:u.POS,x:-1,y:1},{type:u.POS,x:-1,y:0},{type:u.POS,x:0,y:1},{type:u.POS,x:0,y:-1},{type:u.POS,x:1,y:1},{type:u.POS,x:1,y:0},{type:u.POS,x:-1,y:-1},{type:u.POS,x:1,y:-1}],isPromote:!1,toPromote:l.NONE,fromPromote:l.NONE},{name:"と",fullName:"と金",boardName:"TO",moves:[{type:u.POS,x:-1,y:1},{type:u.POS,x:-1,y:0},{type:u.POS,x:0,y:1},{type:u.POS,x:0,y:-1},{type:u.POS,x:1,y:1},{type:u.POS,x:1,y:0}],isPromote:!0,toPromote:l.NONE,fromPromote:l.FU},{name:"成香",fullName:"成香",boardName:"NY",moves:[{type:u.POS,x:-1,y:1},{type:u.POS,x:-1,y:0},{type:u.POS,x:0,y:1},{type:u.POS,x:0,y:-1},{type:u.POS,x:1,y:1},{type:u.POS,x:1,y:0}],isPromote:!0,toPromote:l.NONE,fromPromote:l.KY},{name:"成桂",fullName:"成桂",boardName:"NK",moves:[{type:u.POS,x:-1,y:1},{type:u.POS,x:-1,y:0},{type:u.POS,x:0,y:1},{type:u.POS,x:0,y:-1},{type:u.POS,x:1,y:1},{type:u.POS,x:1,y:0}],isPromote:!0,toPromote:l.NONE,fromPromote:l.KE},{name:"成銀",fullName:"成銀",boardName:"NG",moves:[{type:u.POS,x:-1,y:1},{type:u.POS,x:-1,y:0},{type:u.POS,x:0,y:1},{type:u.POS,x:0,y:-1},{type:u.POS,x:1,y:1},{type:u.POS,x:1,y:0}],isPromote:!0,toPromote:l.NONE,fromPromote:l.GI},{name:"馬",fullName:"竜馬",boardName:"UM",moves:[{type:u.DIR,x:-1,y:1},{type:u.POS,x:-1,y:0},{type:u.POS,x:0,y:1},{type:u.POS,x:0,y:-1},{type:u.DIR,x:1,y:1},{type:u.POS,x:1,y:0},{type:u.DIR,x:1,y:-1},{type:u.DIR,x:-1,y:-1}],isPromote:!0,toPromote:l.NONE,fromPromote:l.KA},{name:"龍",fullName:"龍王",boardName:"RY",moves:[{type:u.POS,x:-1,y:1},{type:u.POS,x:-1,y:0},{type:u.POS,x:0,y:1},{type:u.POS,x:0,y:-1},{type:u.POS,x:1,y:1},{type:u.POS,x:1,y:0},{type:u.POS,x:1,y:-1},{type:u.POS,x:-1,y:-1},{type:u.DIR,x:1,y:0},{type:u.DIR,x:0,y:1},{type:u.DIR,x:-1,y:0},{type:u.DIR,x:0,y:-1}],isPromote:!0,toPromote:l.NONE,fromPromote:l.HI}],o}(),f=function(){function o(){}return o.oppoPlayer=function(o){return o===s.SENTE?s.GOTE:s.SENTE},o.deepCopy=function(o){return JSON.parse(JSON.stringify(o))},o.makeEmptyBoard=function(){for(var o=[],e=0;e<9;e++){for(var t=[],r=0;r<9;r++)t.push(0);o.push(t)}return o},o.reverseBoard=function(o){return o.slice().reverse().map(function(o){return o.slice().reverse()})},o}(),h=function(){function o(e,t){if(!o.inRange(e,t))throw new Error("盤面座標の値が範囲外です。");this._ax=9-e,this._ay=t-1,this._kx=e,this._ky=t}return o.inRange=function(o,e){return o>0&&o<=9&&e>0&&e<=9},o.makePosFromIndex=function(e,t){return new o(9-e,t+1)},o.prototype.reverse=function(){return new o(10-this._kx,10-this._ky)},Object.defineProperty(o.prototype,"ax",{get:function(){return this._ax},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"ay",{get:function(){return this._ay},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"x",{get:function(){return this._kx},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"y",{get:function(){return this._ky},enumerable:!0,configurable:!0}),o}(),m=function(){function o(o){if(this._name="初期配置",this._komaNum=l.NONE,this._from=null,this._to=null,this._noMove=!1,this._color=s.SENTE,this._captureNum=null,this._isPromote=!1,this._comments=null,this._isPut=!1,this._name=this.getMoveName(o),this._moveObj=o,o.hasOwnProperty("comments")&&(this._comments=o.comments),this._isPut=!1,o.hasOwnProperty("move")){var e=o.move;if(e.hasOwnProperty("from")){var t=e.from;this._from=new h(t.x,t.y)}else this._isPut=!0;if(!e.hasOwnProperty("to"))throw new Error('指し手オブジェクトに"to"プロパティがありません。');var r=e.to;if(this._to=new h(r.x,r.y),!e.hasOwnProperty("color"))throw new Error('指し手オブジェクトに"color"プロパティがありません。');if(this._color=e.color,!e.hasOwnProperty("piece"))throw new Error('指し手オブジェクトに"piece"プロパティがありません。');this._komaNum=p.komaAtoi(e.piece),e.hasOwnProperty("promote")&&(this._isPromote=e.promote),e.hasOwnProperty("capture")&&(this._captureNum=p.komaAtoi(e.capture))}else this._from=null,this._to=null;this.from||this.to||(this._noMove=!0)}return Object.defineProperty(o.prototype,"boardObj",{get:function(){var o=this._isPromote?p.getJKFString(p.getPromote(this._komaNum)):p.getJKFString(this._komaNum);return{color:this.color,kind:o}},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"moveObj",{get:function(){return this._moveObj},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isPut",{get:function(){return this._isPut},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"from",{get:function(){return this._from},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"to",{get:function(){return this._to},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"noMove",{get:function(){return this._noMove},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"color",{get:function(){return this._color},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"komaNum",{get:function(){return this._komaNum},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"comments",{get:function(){return this._comments},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"captureNum",{get:function(){return this._captureNum?p.getOrigin(this._captureNum):null},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"pureCaptureNum",{get:function(){return this._captureNum},enumerable:!0,configurable:!0}),o.prototype.addComment=function(o){Array.isArray(this._comments)?this._comments.push(o):this._comments=[o]},o.prototype.removeComment=function(){this._comments=null},o.prototype.getMoveName=function(o){if(o.hasOwnProperty("move")){var e=o.move;if(e.to&&e.hasOwnProperty("color")&&e.hasOwnProperty("piece")){var t=p.komaAtoi(e.piece),r=p.getKanji(t),n=e.color===s.SENTE?"☗":"☖",i="同";return e.hasOwnProperty("same")||(i=e.to.x+["零","一","二","三","四","五","六","七","八","九"][e.to.y]),e.hasOwnProperty("relative")&&e.relative.split("").forEach(function(o){switch(o){case"L":r+="左";break;case"C":r+="直";break;case"R":r+="右";break;case"U":r+="上";break;case"M":r+="寄";break;case"D":r+="引";break;case"H":r+="打"}}),e.hasOwnProperty("promote")&&(r=e.promote?r+"成":r),n+i+r}throw new Error("指し手オブジェクトに必要なプロパティが定義されていません。")}return"初期局面"},o}();module.exports=m;var y=function(){function o(o,e,t,r){this._next=[],this._prev=null,this._select=-1,this._isBranch=!1,this._index=e,this._prev=t,this._moveObj=o,this._isBranch=r,this._info=new m(o)}return Object.defineProperty(o.prototype,"prev",{get:function(){return this._prev},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"next",{get:function(){return this._next},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"info",{get:function(){return this._info},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"moveObj",{get:function(){return this._moveObj},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"select",{get:function(){return this._select},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isBranch",{get:function(){return this._isBranch},enumerable:!0,configurable:!0}),o.prototype.addNext=function(o){this._next.push(o),-1===this.select&&(this._select=0)},o.prototype.deleteNext=function(o){var e=this;return this._next.length?(this._next.forEach(function(t,r){if(t===o)return e._next.splice(r,1),e.select===r?e.next.length>=1?e._select=0:e._select=-1:e.select>r&&(e.next.length>=1?e._select--:e._select=-1),!0}),!1):(console.error("このノードには次の指し手候補が登録されていません。"),!1)},o.prototype.switchFork=function(o){return this.next.length>1?o<this.next.length?(this._select=o,!0):(console.error("指定したインデックスがノードの分岐数を超えています。"),!1):(console.error("この指し手は複数の分岐を持っていません。"),!1)},o.prototype.swapFork=function(o,e){var t=this.next[o],r=this.next[e];return t&&r?(this.select===o?this._select=e:this.select===e&&(this._select=o),this.next[o]=r,this.next[e]=t,!0):(console.error("指定された分岐候補のいずれかが未定義です。"),!1)},o.prototype.branchize=function(){this._isBranch=!0},o}(),k=function(){function o(o){this._moveNodes=[],this._currentMoveNodes=[],this._currentMoves=[],this.makeMoveList(o),this.makeCurrentMoveArray()}return o.prototype.getMove=function(o){return this._currentMoves[o]},o.prototype.getNextMoves=function(o){var e=this;return this._currentMoveNodes[o].next.map(function(o){return e._moveNodes[o].info})},o.prototype.getNextSelect=function(o){return this._currentMoveNodes[o].select},Object.defineProperty(o.prototype,"startNode",{get:function(){return this._moveNodes[0]?this._moveNodes[0]:null},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"currentMoves",{get:function(){return this._currentMoves},enumerable:!0,configurable:!0}),o.prototype.addMove=function(o,e){"number"==typeof this.makeMoveNode(e,this._currentMoveNodes[o])&&this.makeCurrentMoveArray()},o.prototype.deleteMove=function(o){var e=this._currentMoveNodes[o];this._moveNodes[e.prev].deleteNext(e.index),this.makeCurrentMoveArray()},o.prototype.deleteFork=function(o,e){if("number"==typeof this._currentMoveNodes[o].index){var t=this._currentMoveNodes[o].next[e];"number"==typeof t?this._moveNodes[this._currentMoveNodes[o].index].deleteNext(t):console.error("削除対象の分岐が存在しません。"),this.makeCurrentMoveArray()}else console.error("指し手が見つかりません。")},o.prototype.switchFork=function(o,e){if("number"!=typeof this._currentMoveNodes[o].index)throw new Error("分岐切り替え処理に失敗しました。");if(!this._moveNodes[this._currentMoveNodes[o].index].switchFork(e))throw new Error("分岐切り替え処理に失敗しました。");this.makeCurrentMoveArray()},o.prototype.swapFork=function(o,e,t){if("number"!=typeof this._currentMoveNodes[o].index)throw new Error("指し手が見つかりません。");this._moveNodes[this._currentMoveNodes[o].index].swapFork(e,t)},o.prototype.exportJkfMoves=function(o){void 0===o&&(o=this._moveNodes[0]);for(var e=[],t=o,r=!0;t;){if(("number"==typeof t.prev?this._moveNodes[t.prev].next.length:1)>1&&!r){for(var n=this._moveNodes[t.prev],i=[],c=n.next.length,a=1;a<c;a++)i.push(this.exportJkfMoves(this._moveNodes[n.next[a]]));var s=f.deepCopy(t.moveObj);s.forks=i,e.push(s)}else e.push(t.moveObj);t=t.next.length>=0?this._moveNodes[t.next[0]]:null,r=!1}return e},o.prototype.makeMoveList=function(o){var e=this,t=-1;o.forEach(function(o){var r=e._moveNodes[t]?e._moveNodes[t]:null;t=e.makeMoveNode(o,r)})},o.prototype.makeMoveNode=function(o,e){var t=this,r=!1;if(!(e&&e.next.length>0&&(e.next.forEach(function(e){JSON.stringify(o)===JSON.stringify(t._moveNodes[e].moveObj)&&(r=!0)}),r))){var n=this.makePrimitiveMoveNode(o,e);return o.hasOwnProperty("forks")&&o.forks.forEach(function(o){var r=e;o.forEach(function(o){var e=t.makeMoveNode(o,r);r=t._moveNodes[e]?t._moveNodes[e]:null}),r=e}),n}console.error("同一の指し手が含まれています。")},o.prototype.makePrimitiveMoveNode=function(o,e){var t=this,r=!!(e&&e.next.length>0),n=e?e.index:null,i=new y(o,this._moveNodes.length,n,r);return this._moveNodes.push(i),e&&(e.addNext(i.index),r&&e.next.forEach(function(o){t._moveNodes[o].branchize()})),i.index},o.prototype.makeCurrentMoveArray=function(){this._currentMoves=[],this._currentMoveNodes=[];for(var o=this._moveNodes[0]?this._moveNodes[0]:null;o;)this._currentMoveNodes.push(o),this._currentMoves.push(o.info),o=o.next[o.select]?this._moveNodes[o.next[o.select]]:null},o}(),v=function(){function o(o,e,t){void 0===e&&(e=[{},{}]),void 0===t&&(t=s.SENTE),this._nomove=!0,this._board=o,this._reverseBoard=f.reverseBoard(o),this._hands=e,this._color=t,this._initBoard=f.deepCopy(o),this._initHands=f.deepCopy(e),this._initColor=t}return o.prototype.applyMove=function(o){if(o.isPut){var e=o.to;!this.isExists(e.ax,e.ay)&&this.canSet(e,o.komaNum,this.nextColor)&&(this.setBoardPiece(e,o.boardObj),this.deleteHand(o.color,o.komaNum))}else if(o.from&&o.to){var t=o.from;if(e=o.to,this.setBoardPiece(t,{}),this.setBoardPiece(e,o.boardObj),o.captureNum){var r=o.captureNum;this.addHand(o.color,r)}}else if(o.from||o.to)throw new Error("移動前、もしくは移動先の盤面座標が未定義です。");this._nomove=o.noMove,this._color=o.color},o.prototype.rewindMove=function(o){if(o.isPut){var e=o.to;this.setBoardPiece(e,{}),this.addHand(o.color,o.komaNum)}else{if(!o.from||!o.to)throw new Error("移動前、もしくは移動先の盤面座標が未定義です。");var t=o.from;if(e=o.to,this.setBoardPiece(e,{}),this.setBoardPiece(t,{color:o.color,kind:p.getJKFString(o.komaNum)}),o.captureNum){var r=o.pureCaptureNum;this.setBoardPiece(e,{color:f.oppoPlayer(o.color),kind:p.getJKFString(r)});var n=p.getOrigin(r);this.deleteHand(o.color,n)}}this._nomove=o.noMove,this._color=f.oppoPlayer(o.color)},o.prototype.isMovable=function(o,e){var t=this;void 0===e&&(e=null);var r=this._board[o.ay][o.ax].hasOwnProperty("kind")?p.komaAtoi(this._board[o.ay][o.ax].kind):null;if(!r)return!1;var n=this._board[o.ay][o.ax].color;return p.getMoves(r).some(function(r){var i=r.x,c=r.y;if(n===s.SENTE?c*=-1:i*=-1,r.type===u.POS)return e?o.x+i===e.x&&o.y+c===e.y&&!!t.isEnterable(e.x,e.y,n):!!t.isEnterable(o.x+i,o.y+c,n);for(var a=!0,l=o.x,d=o.y;a;){l+=i,d+=c;var p=t.isEnterable(l,d,n);if(!p)return!1;if(t.isExists(p.ax,p.ay)&&(a=!1),!e)return!0;if(p.x===e.x&&p.y===e.y)return!0}return!1})},o.prototype.getKomaMoves=function(o){var e=this,t=f.makeEmptyBoard(),r=this._board[o.ay][o.ax].hasOwnProperty("kind")?p.komaAtoi(this._board[o.ay][o.ax].kind):null;if(!r)return t;var n=this._board[o.ay][o.ax].color;return p.getMoves(r).forEach(function(i){var c=i.x,a=i.y;if(n===s.SENTE?a*=-1:c*=-1,i.type!==u.POS){for(var l=!0,d=o.x,p=o.y;l;){d+=c,p+=a;var f=e.isEnterable(d,p,n);f?(e.isExists(f.ax,f.ay)&&(l=!1),t[f.ay][f.ax]=e.canSet(f,r,n,!1)?1:2):l=!1}return!1}var h=e.isEnterable(o.x+c,o.y+a,n);h&&(t[h.ay][h.ax]=e.canSet(h,r,n,!1)?1:2)}),t},o.prototype.getMovables=function(){for(var o=f.makeEmptyBoard(),e=1;e<10;e++)for(var t=1;t<10;t++){var r=new h(t,e);this.isMovable(r)&&this._board[r.ay][r.ax].color===this.nextColor&&(o[r.ay][r.ax]=1)}return o},o.prototype.getPutables=function(o){for(var e=f.makeEmptyBoard(),t=0;t<9;t++)for(var r=0;r<9;r++){var n=h.makePosFromIndex(r,t);!this.isExists(n.ax,n.ay)&&this.canSet(n,p.komaAtoi(o),this.nextColor)&&(e[n.ay][n.ax]=1)}return e},o.prototype.isInHand=function(o,e){var t=p.komaItoa(e);return!!(this._hands[o]&&this._hands[o].hasOwnProperty(t)&&this._hands[o][t]>=1)},Object.defineProperty(o.prototype,"initData",{get:function(){var o={color:s.SENTE,board:[],hands:[]};return this._initBoard&&(o.board=this._initBoard),this._initHands&&(o.hands=this._initHands),this._initColor&&(o.color=this._initColor),o},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"color",{get:function(){return this._color},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"nextColor",{get:function(){return this._nomove?this.color:f.oppoPlayer(this.color)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"board",{get:function(){return this._board},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"reverseBoard",{get:function(){return this._reverseBoard},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"hands",{get:function(){return this._hands},enumerable:!0,configurable:!0}),o.prototype.getBoardPiece=function(o,e){var t=new h(o,e);return this._board[t.ay][t.ax]},o.prototype.setBoardPiece=function(o,e){if(o){this._board[o.ay][o.ax]=f.deepCopy(e);var t=o.reverse();this._reverseBoard[t.ay][t.ax]=f.deepCopy(e)}},o.prototype.addHand=function(o,e){if(this._hands.hasOwnProperty(o)){var t=p.getJKFString(e);this._hands[o].hasOwnProperty(t)?this._hands[o][t]++:this._hands[o][t]=1}else console.error("指定されたプレイヤーの値が想定しない値です。")},o.prototype.deleteHand=function(o,e){if(this._hands.hasOwnProperty(o)){var t=p.getJKFString(e);this._hands[o].hasOwnProperty(t)?(this._hands[o][t]--,this._hands[o][t]||delete this._hands[o][t]):console.error("指定された駒番号の駒が手駒にありません。")}else console.error("指定されたプレイヤーの値が想定しない値です。")},o.prototype.isEnterable=function(o,e,t){if(h.inRange(o,e)){var r=new h(o,e);return this.isExists(r.ax,r.ay)?this._board[r.ay][r.ax].color!==t&&r:r}return!1},o.prototype.isExists=function(o,e){var t=this._board[e][o];return!!Object.keys(t).length},o.prototype.canSet=function(o,e,t,r){var n=this;return void 0===r&&(r=!0),p.getMoves(e).some(function(i){var c=i.x,a=i.y;if(t===s.SENTE?a*=-1:c*=-1,h.inRange(o.x+c,o.y+a)){if(e!==l.FU)return!0;if(r)for(var d=0;d<9;d++)if(d!==o.ay&&n._board[d][o.ax].kind===p.komaItoa(l.FU)&&n._board[d][o.ax].color===t)return!1;return!0}return!1})},o}(),b=function(){function e(o,e){void 0===o&&(o={header:{},moves:[{}]}),void 0===e&&(e=!1),this._currentNum=0,this._field=new v(p.initBoards[d.HIRATE]),this.moveData=new k([{}]),this._header={},this.initial=null,this.preset="HIRATE",this.readonly=e,this.load(o)}return Object.defineProperty(e.prototype,"moves",{get:function(){return this.moveData.currentMoves},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastMove",{get:function(){return this.moveData.currentMoves[this.currentNum]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"comment",{get:function(){return this.moveData.getMove(this.currentNum).comments},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"board",{get:function(){return this._field.board},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reverseBoard",{get:function(){return this._field.reverseBoard},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hands",{get:function(){return this._field.hands},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextMoves",{get:function(){return this.moveData.getNextMoves(this._currentNum)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextSelect",{get:function(){return this.moveData.getNextSelect(this._currentNum)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._field.color},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentNum",{get:function(){return this._currentNum},set:function(o){this.go(o)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFork",{get:function(){return this.moveData.getNextMoves(this.currentNum).length>1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"header",{get:function(){return this._header},enumerable:!0,configurable:!0}),e.prototype.getBoardPiece=function(o,e){return this._field.getBoardPiece(o,e)},e.prototype.addComment=function(o){this.moveData.getMove(this.currentNum).addComment(o)},e.prototype.resetComment=function(){this.moveData.getMove(this.currentNum).removeComment()},e.prototype.export=function(){var e={header:{},moves:[{}]};return"object"==o(this.initial)&&(e.initial=this.initial),this.preset!==d.HIRATE&&(e.initial={preset:this.preset},this.preset===d.OTHER&&(e.initial.data=this._field.initData)),"object"==o(this.header)&&Object.keys(this.header).length&&(e.header=this.header),e.moves=this.moveData.exportJkfMoves(),e},e.prototype.go=function(o){if(o>=0&&o<this.moveData.currentMoves.length){if(this._currentNum>o)for(var e=this._currentNum;e>o;){var t=this.moveData.getMove(e);this._field.rewindMove(t),e--}else if(this._currentNum<o)for(e=this._currentNum;e<o;){var r=this.moveData.getMove(e+1);this._field.applyMove(r),e++}this._currentNum=o}else console.error("指定の指し手番号 "+o+" は範囲外です。0以上で"+this.moveData.currentMoves.length+"より小さい必要があります。")},Object.defineProperty(e.prototype,"currentMove",{get:function(){return this.moveData.currentMoves[this.currentNum]},enumerable:!0,configurable:!0}),e.prototype.dispCurrentInfo=function(){var o="";return o+=this._currentNum+"手目\n\n",o+=this.dispHand(s.GOTE)+"\n",(o+=this.dispBoard()+"\n")+(this.dispHand(s.SENTE)+"\n\n")},e.prototype.dispBoard=function(){if(this._field.board){var o="";return o+=" ＿＿＿＿＿＿＿＿＿\n",this._field.board.forEach(function(e){o+="|",e.forEach(function(e){e.hasOwnProperty("kind")?o+=p.getKanji(p.komaAtoi(e.kind)):o+="　"}),o+="|\n"}),o+=" ￣￣￣￣￣￣￣￣￣"}return""},e.prototype.dispKifuMoves=function(){var o=this,e="";return this.moveData.currentMoves.forEach(function(t,r){r===o._currentNum?e+=">":e+=" ",e+=r+": "+t.name+"\n"}),e},e.prototype.dispNextMoves=function(){var o=this.moveData.getNextMoves(this._currentNum),e=this.moveData.getNextSelect(this._currentNum),t="";return o.forEach(function(o,r){t+=r===e?">":" ",t+=r+": "+o.name+"\n"}),t},e.prototype.dispHand=function(o){var e=this._field.hands[o],t=o===s.SENTE?"[先手持ち駒] ":"[後手持ち駒] ";for(var r in e){var n=e[r];t+=p.getKanji(p.komaAtoi(r))+":"+n.toString()+" \n"}return t},e.prototype.deleteMove=function(o){this.isEditable&&(o<1?console.error("初期盤面は削除できません。"):(this.currentNum<=o&&this.go(o-1),this.moveData.deleteMove(o)))},e.prototype.addMovefromObj=function(o,e){if(void 0===e&&(e=null),this.isEditable){var t;if(t="string"==typeof e?{move:o,comments:[e]}:Array.isArray(e)?{move:o,comments:e}:{move:o},o.to)if(o.from){if(!this._field.isMovable(new h(o.from.x,o.from.y),new h(o.to.x,o.to.y)))return void console.error("指定された指し手は移動不可能です。")}else{if(!this._field.isInHand(f.oppoPlayer(this._field.color),p.komaAtoi(o.piece)))return void console.error("打つ駒が手持ち駒の中にありません。");if(!a(this.getBoardPiece(o.to.x,o.to.y),{}))return void console.error("持ち駒から配置する指し手の場合は空きマスを指定して下さい。","TO:[x:"+o.to.x+",y:"+o.to.y+"]",this.getBoardPiece(o.to.x,o.to.y))}this.moveData.addMove(this._currentNum,t)}},e.prototype.addBoardMove=function(o,e,t,r,n,i){void 0===n&&(n=!1),void 0===i&&(i=null);var c=this.getBoardPiece(o,e),a=null;c.hasOwnProperty("color")&&c.hasOwnProperty("kind")?(n=!(!n||!p.getPromote(p.komaAtoi(c.kind))),(a=this.makeMoveData(c.kind,o,e,t,r,n))&&this.addMovefromObj(a,i)):console.error("fromの座標に駒が存在しません。")},e.prototype.addHandMove=function(o,e,t,r){void 0===r&&(r=null);var n=this.makeMoveData(o,null,null,e,t,!1);n&&this.addMovefromObj(n,r)},e.prototype.getKomaMoves=function(o,e,t){void 0===t&&(t=!1);var r=this._field.getKomaMoves(new h(o,e));return t?f.reverseBoard(r):r},e.prototype.getMovables=function(o){void 0===o&&(o=!1);var e=this._field.getMovables();return o?f.reverseBoard(e):e},e.prototype.getPutables=function(o,e){void 0===e&&(e=!1);var t=this._field.getPutables(o);return e?f.reverseBoard(t):t},e.prototype.haveFork=function(o){return o<this.moves.length?this.moveData.getNextMoves(o).length>1:(console.log("現在の手数を超える番号が指定されています。"),!1)},e.prototype.switchFork=function(o){this.isFork?this.moveData.switchFork(this.currentNum,o):console.error("現在の指し手は分岐を持っていません。")},e.prototype.deleteFork=function(o){this.isEditable&&(this.isFork?this.moveData.deleteFork(this.currentNum,o):console.error("現在の指し手は分岐を持っていません。"))},e.prototype.swapFork=function(o,e){this.isEditable&&(this.isFork?this.moveData.swapFork(this.currentNum,o,e):console.log("現在の指し手は分岐を持っていません。"))},e.prototype.addInfo=function(o,e){this.isEditable&&(this._header[o]=e)},e.prototype.deleteInfo=function(o){this.isEditable&&delete this._header[o]},e.prototype.load=function(o){var e,t=[{},{}];if(o.hasOwnProperty("moves")?this.moveData=new k(o.moves):this.moveData=new k([{}]),e=f.deepCopy(p.initBoards[d.HIRATE]),o.hasOwnProperty("initial")){if(!o.initial.hasOwnProperty("preset"))throw Error("初期状態のプリセットが未定義です。");switch(o.initial.preset){case d.HIRATE:break;case d.KYO:this.preset=d.KYO,e=f.deepCopy(p.initBoards[d.KYO]);break;case d.KAKU:this.preset=d.KAKU,e=f.deepCopy(p.initBoards[d.KAKU]);break;case d.HISHA:this.preset=d.HISHA,e=f.deepCopy(p.initBoards[d.HISHA]);break;case d.HIKYO:this.preset=d.HIKYO,e=f.deepCopy(p.initBoards[d.HIKYO]);break;case d.NI:this.preset=d.NI,e=f.deepCopy(p.initBoards[d.NI]);break;case d.YON:this.preset=d.YON,e=f.deepCopy(p.initBoards[d.YON]);break;case d.ROKU:this.preset=d.ROKU,e=f.deepCopy(p.initBoards[d.ROKU]);break;case d.HACHI:this.preset=d.HACHI,e=f.deepCopy(p.initBoards[d.HACHI]);break;case d.OTHER:this.preset=d.OTHER,e=o.initial.data.board,t=o.initial.data.hands}}this._field=new v(e,t),this.go(0),o.hasOwnProperty("initial")&&(this.initial=o.initial),o.hasOwnProperty("header")&&(this._header=o.header)},e.prototype.isEditable=function(){return!this.readonly||(console.error("この棋譜は読み取り専用です。"),!1)},e.prototype.makeMoveData=function(o,e,t,r,n,i){var c=this;void 0===i&&(i=!1);var l=this.lastMove.noMove?this.lastMove.color:f.oppoPlayer(this.lastMove.color),d={to:{x:r,y:n},color:l,piece:o},u=new h(r,n);if("number"==typeof e&&"number"==typeof t){if(d.from={x:e,y:t},!h.inRange(e,t))return console.error("fromの座標が盤面の範囲外です。"),null;var p=this.getBoardPiece(e,t);if(p&&p.hasOwnProperty("kind")&&p.color!==l)return console.error("相手の駒は移動できません。"),null}if(!h.inRange(r,n))return console.error("toの座標が盤面の範囲外です。"),null;i&&(d.promote=!0),d.to&&a(this.lastMove.to,new h(d.to.x,d.to.y))&&(d.same=!0);var m=this.getBoardPiece(r,n);if(m&&m.hasOwnProperty("kind")){if(m.color===l)return console.error("自分の駒を取る移動です。"),null;d.capture=m.kind}var y=[];if(this.board.forEach(function(o,r){o.forEach(function(o,n){var i=h.makePosFromIndex(n,r);o.hasOwnProperty("kind")&&(o.kind!==d.piece||o.color!==d.color||i.x===e&&i.y===t||c._field.isMovable(i,u)&&y.push(i))})}),y.length)if(d.relative="",null!=e&&null!=t){var k=!0,v=!0,b=!0,O=!0,P=new h(e,t);y.forEach(function(o){l===s.SENTE?(o.x<P.x?O=!1:o.x>P.x?b=!1:k=!1,o.y===P.y&&(v=!1)):(o.x<P.x?b=!1:o.x>P.x?O=!1:k=!1,o.y===P.y&&(v=!1))});var g="",N="";O&&!b?g="R":!O&&b&&(g="L"),e===r&&(l===s.SENTE&&t>n?g="C":l===s.GOTE&&t<n&&(g="C")),t>n?(N="U","C"===g&&(N="")):N=t<n?"D":"M",d.relative=k&&v?N:k&&!v?g:!k&&v?N:g+N}else d.relative="H";return d},e}(),O=function(){function o(o){this.move=o}return Object.defineProperty(o.prototype,"moveObj",{get:function(){return this.move.moveObj},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isPut",{get:function(){return this.move.isPut},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"from",{get:function(){return this.move.from?{x:this.move.from.x,y:this.move.from.y}:null},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"to",{get:function(){return this.move.to?{x:this.move.to.x,y:this.move.to.y}:null},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"color",{get:function(){return this.move.color},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"name",{get:function(){return this.move.name},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"piece",{get:function(){return p.komaItoa(this.move.komaNum)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"capture",{get:function(){return this.move.captureNum?p.komaItoa(this.move.captureNum):null},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"pureCapture",{get:function(){return this.move.pureCaptureNum?p.komaItoa(this.move.pureCaptureNum):null},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"comments",{get:function(){return this.move.comments},enumerable:!0,configurable:!0}),o}(),P=function(){function o(o,e){void 0===o&&(o={header:{},moves:[{}]}),void 0===e&&(e=!1),this.editor=new b(o,e)}return Object.defineProperty(o.prototype,"currentNum",{get:function(){return this.editor.currentNum},set:function(o){this.editor.go(o)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"board",{get:function(){return this.editor.board},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"reverseBoard",{get:function(){return this.editor.reverseBoard},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"hands",{get:function(){return this.editor.hands},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"comment",{get:function(){return this.editor.comment},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isFork",{get:function(){return this.editor.isFork},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"header",{get:function(){return this.editor.header},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"moves",{get:function(){return this.editor.moves.map(function(o){return new O(o)})},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"lastMove",{get:function(){return new O(this.editor.lastMove)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"nextMoves",{get:function(){return this.editor.nextMoves.map(function(o){return new O(o)})},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"nextSelect",{get:function(){return this.editor.nextSelect},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"color",{get:function(){return this.editor.color},enumerable:!0,configurable:!0}),o.prototype.go=function(o){this.editor.go(o)},o.prototype.dispKifuMoves=function(){return this.editor.dispKifuMoves()},o.prototype.dispNextMoves=function(){return this.editor.dispNextMoves()},o.prototype.dispCurrentInfo=function(){return this.editor.dispCurrentInfo()},o.prototype.haveFork=function(o){return this.editor.haveFork(o)},o.prototype.switchFork=function(o){this.editor.switchFork(o)},o.prototype.deleteFork=function(o){this.editor.deleteFork(o)},o.prototype.addBoardMove=function(o,e,t,r,n,i){void 0===n&&(n=!1),void 0===i&&(i=null),this.editor.addBoardMove(o,e,t,r,n,i)},o.prototype.addHandMove=function(o,e,t,r){void 0===r&&(r=null),this.editor.addHandMove(o,e,t,r)},o.prototype.deleteMove=function(o){this.editor.deleteMove(o)},o.prototype.getBoardPiece=function(o,e){return this.editor.getBoardPiece(o,e)},o.prototype.addComment=function(o){this.editor.addComment(o)},o.prototype.resetComment=function(){this.editor.resetComment()},o.prototype.getKomaMoves=function(o,e,t){return void 0===t&&(t=!1),this.editor.getKomaMoves(o,e,t)},o.prototype.getMovables=function(o){return void 0===o&&(o=!1),this.editor.getMovables(o)},o.prototype.getPutables=function(o,e){return void 0===e&&(e=!1),this.editor.getPutables(o,e)},o.prototype.export=function(){return this.editor.export()},o.prototype.load=function(o){this.editor.load(o)},o.prototype.addInfo=function(o,e){this.editor.addInfo(o,e)},o.prototype.deleteInfo=function(o){this.editor.deleteInfo(o)},o}();module.exports=P,exports.default=P;
},{}],135:[function(require,module,exports) {
!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.StateMachine=n():t.StateMachine=n()}(this,function(){return function(t){function n(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,n),s.l=!0,s.exports}var i={};return n.m=t,n.c=i,n.i=function(t){return t},n.d=function(t,i,e){n.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:e})},n.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(i,"a",i),i},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=5)}([function(t,n,i){"use strict";t.exports=function(t,n){var i,e,s;for(i=1;i<arguments.length;i++)for(s in e=arguments[i])e.hasOwnProperty(s)&&(t[s]=e[s]);return t}},function(t,n,i){"use strict";var e=i(0);t.exports={build:function(t,n){var i,s,r,o=n.plugins;for(i=0,s=o.length;i<s;i++)(r=o[i]).methods&&e(t,r.methods),r.properties&&Object.defineProperties(t,r.properties)},hook:function(t,n,i){var e,s,r,o,a=t.config.plugins,f=[t.context];for(i&&(f=f.concat(i)),e=0,s=a.length;e<s;e++)o=a[e],(r=a[e][n])&&r.apply(o,f)}}},function(t,n,i){"use strict";function e(t){if(0===t.length)return t;var n,i,e=t.split(/[_-]/);if(1===e.length&&e[0][0].toLowerCase()===e[0][0])return t;for(i=e[0].toLowerCase(),n=1;n<e.length;n++)i=i+e[n].charAt(0).toUpperCase()+e[n].substring(1).toLowerCase();return i}e.prepended=function(t,n){return t+(n=e(n))[0].toUpperCase()+n.substring(1)},t.exports=e},function(t,n,i){"use strict";function e(t,n){t=t||{},this.options=t,this.defaults=n.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(t.init),this.data=this.configureData(t.data),this.methods=this.configureMethods(t.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(t.transitions||[]),this.plugins=this.configurePlugins(t.plugins,n.plugin)}var s=i(0),r=i(2);s(e.prototype,{addState:function(t){this.map[t]||(this.states.push(t),this.addStateLifecycleNames(t),this.map[t]={})},addStateLifecycleNames:function(t){this.lifecycle.onEnter[t]=r.prepended("onEnter",t),this.lifecycle.onLeave[t]=r.prepended("onLeave",t),this.lifecycle.on[t]=r.prepended("on",t)},addTransition:function(t){this.transitions.indexOf(t)<0&&(this.transitions.push(t),this.addTransitionLifecycleNames(t))},addTransitionLifecycleNames:function(t){this.lifecycle.onBefore[t]=r.prepended("onBefore",t),this.lifecycle.onAfter[t]=r.prepended("onAfter",t),this.lifecycle.on[t]=r.prepended("on",t)},mapTransition:function(t){var n=t.name,i=t.from,e=t.to;return this.addState(i),"function"!=typeof e&&this.addState(e),this.addTransition(n),this.map[i][n]=t,t},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(t){return"string"==typeof t?this.mapTransition(s({},this.defaults.init,{to:t,active:!0})):"object"==typeof t?this.mapTransition(s({},this.defaults.init,t,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(t){return"function"==typeof t?t:"object"==typeof t?function(){return t}:function(){return{}}},configureMethods:function(t){return t||{}},configurePlugins:function(t,n){var i,e,s;for(i=0,e=(t=t||[]).length;i<e;i++)"function"==typeof(s=t[i])&&(t[i]=s=s()),s.configure&&s.configure(this);return t},configureTransitions:function(t){var n,i,e,s,r,o=this.defaults.wildcard;for(i=0;i<t.length;i++)for(e=t[i],s=Array.isArray(e.from)?e.from:[e.from||o],r=e.to||o,n=0;n<s.length;n++)this.mapTransition({name:e.name,from:s[n],to:r})},transitionFor:function(t,n){var i=this.defaults.wildcard;return this.map[t][n]||this.map[i][n]},transitionsFor:function(t){var n=this.defaults.wildcard;return Object.keys(this.map[t]).concat(Object.keys(this.map[n]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),t.exports=e},function(t,n,i){function e(t,n){this.context=t,this.config=n,this.state=n.init.from,this.observers=[t]}var s=i(0),r=i(6),o=i(1),a=[null,[]];s(e.prototype,{init:function(t){if(s(this.context,this.config.data.apply(this.context,t)),o.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(t){return Array.isArray(t)?t.indexOf(this.state)>=0:this.state===t},isPending:function(){return this.pending},can:function(t){return!this.isPending()&&!!this.seek(t)},cannot:function(t){return!this.can(t)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(t,n){var i=this.config.defaults.wildcard,e=this.config.transitionFor(this.state,t),s=e&&e.to;return"function"==typeof s?s.apply(this.context,n):s===i?this.state:s},fire:function(t,n){return this.transit(t,this.state,this.seek(t,n),n)},transit:function(t,n,i,e){var s=this.config.lifecycle,r=this.config.options.observeUnchangedState||n!==i;return i?this.isPending()?this.context.onPendingTransition(t,n,i):(this.config.addState(i),this.beginTransit(),e.unshift({transition:t,from:n,to:i,fsm:this.context}),this.observeEvents([this.observersForEvent(s.onBefore.transition),this.observersForEvent(s.onBefore[t]),r?this.observersForEvent(s.onLeave.state):a,r?this.observersForEvent(s.onLeave[n]):a,this.observersForEvent(s.on.transition),r?["doTransit",[this]]:a,r?this.observersForEvent(s.onEnter.state):a,r?this.observersForEvent(s.onEnter[i]):a,r?this.observersForEvent(s.on[i]):a,this.observersForEvent(s.onAfter.transition),this.observersForEvent(s.onAfter[t]),this.observersForEvent(s.on[t])],e)):this.context.onInvalidTransition(t,n,i)},beginTransit:function(){this.pending=!0},endTransit:function(t){return this.pending=!1,t},failTransit:function(t){throw this.pending=!1,t},doTransit:function(t){this.state=t.to},observe:function(t){if(2===t.length){var n={};n[t[0]]=t[1],this.observers.push(n)}else this.observers.push(t[0])},observersForEvent:function(t){for(var n,i=0,e=this.observers.length,s=[];i<e;i++)(n=this.observers[i])[t]&&s.push(n);return[t,s,!0]},observeEvents:function(t,n,i,e){if(0===t.length)return this.endTransit(void 0===e||e);var s=t[0][0],r=t[0][1],a=t[0][2];if(n[0].event=s,s&&a&&s!==i&&o.hook(this,"lifecycle",n),0===r.length)return t.shift(),this.observeEvents(t,n,s,e);var f=r.shift(),c=f[s].apply(f,n);return c&&"function"==typeof c.then?c.then(this.observeEvents.bind(this,t,n,s)).catch(this.failTransit.bind(this)):!1===c?this.endTransit(!1):this.observeEvents(t,n,s,c)},onInvalidTransition:function(t,n,i){throw new r("transition is invalid in current state",t,n,i,this.state)},onPendingTransition:function(t,n,i){throw new r("transition is invalid while previous transition is still in progress",t,n,i,this.state)}}),t.exports=e},function(t,n,i){"use strict";function e(t){return s(this||{},t)}function s(t,n){return r(t,new c(n,e)),t._fsm(),t}function r(t,n){if("object"!=typeof t||Array.isArray(t))throw Error("StateMachine can only be applied to objects");f.build(t,n),Object.defineProperties(t,l),o(t,h),o(t,n.methods),n.allTransitions().forEach(function(n){t[a(n)]=function(){return this._fsm.fire(n,[].slice.call(arguments))}}),t._fsm=function(){this._fsm=new u(this,n),this._fsm.init(arguments)}}var o=i(0),a=i(2),f=i(1),c=i(3),u=i(4),h={is:function(t){return this._fsm.is(t)},can:function(t){return this._fsm.can(t)},cannot:function(t){return this._fsm.cannot(t)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(t,n,i){return this._fsm.onInvalidTransition(t,n,i)},onPendingTransition:function(t,n,i){return this._fsm.onPendingTransition(t,n,i)}},l={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(t){throw Error("use transitions to change state")}}};e.version="3.0.1",e.factory=function(){var t,n;"function"==typeof arguments[0]?(t=arguments[0],n=arguments[1]||{}):(t=function(){this._fsm.apply(this,arguments)},n=arguments[0]||{});var i=new c(n,e);return r(t.prototype,i),t.prototype._fsm.config=i,t},e.apply=s,e.defaults={wildcard:"*",init:{name:"init",from:"none"}},t.exports=e},function(t,n,i){"use strict";t.exports=function(t,n,i,e,s){this.message=t,this.transition=n,this.from=i,this.to=e,this.current=s}}])});
},{}],132:[function(require,module,exports) {
"use strict";exports.__esModule=!0,exports.STATE={TOP:"TOP",NEWKIFU:"NEWKIFU",LOADKIFU:"LOADKIFU",EDITBOARD:"EDITBOARD",EDITINFO:"EDITINFO",EDITMOVE:"EDITMOVE",VIEW:"VIEW"},exports.EDITSTATE={INPUTFROM:"INPUTFROM",INPUTTO:"INPUTTO",INPUTNARI:"INPUTNARI",NOINPUT:"NOINPUT"},exports.CREATESTATE={INPUTKIND:"INPUTKIND",INPUTPOS:"INPUTPOS",KOMAEDIT:"KOMAEDIT"},exports.KOMATYPE={NORMAL:"NORMAL",FROM:"FROM",TO:"TO",PROMOTE:"PROMOTE",KIND:"KIND",POS:"POS",EDIT:"EDIT"},exports.KOMAPLACE={BOARD:"BOARD",HAND:"HAND",UNSET:"UNSET"},exports.PLAYER={SENTE:0,GOTE:1},exports.BAN={HIRATE:0,KOMAOCHI:1,CUSTOM:2},exports.KOMAOCHI={KYO:0,KAKU:1,HISHA:2,HIKYO:3,NI:4,YON:5,ROKU:6,HACHI:7},exports.KIFUTYPE={KIFU:0,JOSEKI:1};
},{}],134:[function(require,module,exports) {
"use strict";exports.__esModule=!0;var e=require("./const"),a=function(){function a(){}return a.reverseBoard=function(e){return e.slice().reverse().map(function(e){return e.slice().reverse()})},a.komaClassName=function(e,a,r){void 0===r&&(r=!1);var c=0,s=r?a===c?"oppo":"prop":a===c?"prop":"oppo",t=null;switch(e){case"FU":t="fu";break;case"KY":t="kyo";break;case"KE":t="kei";break;case"GI":t="gin";break;case"KI":t="kin";break;case"KA":t="kaku";break;case"HI":t="hisha";break;case"OU":t="ou";break;case"TO":t="to";break;case"NY":t="nkyo";break;case"NK":t="nkei";break;case"NG":t="ngin";break;case"UM":t="uma";break;case"RY":t="ryu"}return t?"c-koma_"+s+"_"+t:""},a.komaochiName=function(a){var r="";switch(a){case e.KOMAOCHI.KYO:r="KY";break;case e.KOMAOCHI.KAKU:r="KA";break;case e.KOMAOCHI.HISHA:r="HI";break;case e.KOMAOCHI.HIKYO:r="HIKY";break;case e.KOMAOCHI.NI:r="2";break;case e.KOMAOCHI.YON:r="4";break;case e.KOMAOCHI.ROKU:r="6";break;case e.KOMAOCHI.HACHI:r="8"}return r},a.canPromote=function(e){var a=!1;switch(e){case"FU":case"KY":case"KE":case"GI":case"KA":case"HI":a=!0}return a},a.getAttr=function(e,a){return e&&e.attrs&&e.attrs.hasOwnProperty(a)?e.attrs[a]:null},a.getKifuPos=function(e,a,r){return void 0===r&&(r=!1),{x:r?10-(9-e):9-e,y:r?10-(a+1):a+1}},a.getPromote=function(e){var a=e;switch(e){case"FU":a="TO";break;case"KY":a="NY";break;case"KE":a="NK";break;case"GI":a="NG";break;case"KA":a="UM";break;case"HI":a="RY"}return a},a.getDemote=function(e){var a=e;switch(e){case"TO":a="FU";break;case"NY":a="KY";break;case"NK":a="KE";break;case"NG":a="GI";break;case"UM":a="KA";break;case"RY":a="HI"}return a},a.isPromotable=function(r,c,s,t){return!!a.canPromote(t)&&(s===e.PLAYER.SENTE?c<=3||r<=3:s===e.PLAYER.GOTE&&(c>=7||r>=7))},a.isPromoted=function(e){var a=!1;switch(e){case"TO":case"NY":case"NK":case"NG":case"UM":case"RY":a=!0}return a},a.oppoPlayer=function(a){return a===e.PLAYER.SENTE?e.PLAYER.GOTE:e.PLAYER.SENTE},a}();exports.default=a;
},{"./const":132}],91:[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var e=t(require("jkfeditor")),i=t(require("@taoqf/javascript-state-machine")),o=require("./const"),r=t(require("./util")),n=function(){function t(){var t=this;this.jkfEditor=new e.default,this.stateMachine=new i.default({init:o.STATE.TOP,transitions:[{name:"newKifu",from:o.STATE.TOP,to:o.STATE.NEWKIFU},{name:"loadKifu",from:o.STATE.TOP,to:o.STATE.LOADKIFU},{name:"editInfo",from:[o.STATE.NEWKIFU,o.STATE.EDITBOARD],to:o.STATE.EDITINFO},{name:"editMove",from:[o.STATE.EDITINFO,o.STATE.LOADKIFU],to:o.STATE.EDITMOVE},{name:"editBoard",from:o.STATE.NEWKIFU,to:o.STATE.EDITBOARD},{name:"reset",from:[o.STATE.NEWKIFU,o.STATE.LOADKIFU,o.STATE.EDITBOARD,o.STATE.EDITMOVE],to:o.STATE.TOP}],methods:{onEditMove:function(){t.jkfEditor.currentNum===t.jkfEditor.moves.length-1?(t.editStateMachine.inputFrom(),t.setMask(t.jkfEditor.getMovables())):t.editStateMachine.inputReset()}}}),this.editStateMachine=new i.default({init:o.EDITSTATE.INPUTFROM,transitions:[{name:"inputTo",from:o.EDITSTATE.INPUTFROM,to:o.EDITSTATE.INPUTTO},{name:"inputNari",from:o.EDITSTATE.INPUTTO,to:o.EDITSTATE.INPUTNARI},{name:"inputFrom",from:[o.EDITSTATE.NOINPUT,o.EDITSTATE.INPUTFROM,o.EDITSTATE.INPUTTO,o.EDITSTATE.INPUTNARI],to:o.EDITSTATE.INPUTFROM},{name:"inputReset",from:[o.EDITSTATE.NOINPUT,o.EDITSTATE.INPUTFROM,o.EDITSTATE.INPUTTO,o.EDITSTATE.INPUTNARI],to:o.EDITSTATE.NOINPUT}],methods:{onInputFrom:function(){t.setMask(t.jkfEditor.getMovables())},onInputTo:function(){-1!==t.fromX&&-1!==t.fromY?t.setMask(t.jkfEditor.getKomaMoves(t.fromX,t.fromY)):t.setMask(t.jkfEditor.getPutables(t.fromKind))}}}),this.createStateMachine=new i.default({init:o.CREATESTATE.INPUTKIND,transitions:[{name:"inputPos",from:[o.CREATESTATE.INPUTKIND,o.CREATESTATE.INPUTPOS],to:o.CREATESTATE.INPUTPOS},{name:"inputKind",from:[o.CREATESTATE.INPUTKIND,o.CREATESTATE.INPUTPOS,o.CREATESTATE.KOMAEDIT],to:o.CREATESTATE.INPUTKIND},{name:"komaEdit",from:[o.CREATESTATE.INPUTKIND,o.CREATESTATE.INPUTPOS],to:o.CREATESTATE.KOMAEDIT}],methods:{onInputPos:function(){t.setMask(t.createMask(t._createBoard))}}}),this._isReverse=!1,this._isOpenFork=!1,this._isOpenInfo=!1,this._maskArray=this.jkfEditor.getMovables(),this._reverseMaskArray=r.default.reverseBoard(this._maskArray),this._headerInfo={}}return t.prototype.switch_NEWKIFU=function(){this.stateMachine.newKifu()},t.prototype.switch_LOADKIFU=function(){this.stateMachine.loadKifu()},t.prototype.switch_EDITINFO=function(t,e,i,n){switch(void 0===e&&(e=null),void 0===i&&(i=o.KOMAOCHI.NI),void 0===n&&(n=null),t){case o.BAN.HIRATE:this.initBoardPreset=null;break;case o.BAN.KOMAOCHI:this.initBoardPreset=r.default.komaochiName(i);break;case o.BAN.CUSTOM:this.initBoardPreset="OTHER"}e&&(this._headerInfo.title=e),n&&(this._kifuType=n),this.stateMachine.editInfo()},t.prototype.switch_EDITBOARD=function(t,e){this._headerInfo.title=t,this._kifuType=e,this._createBoard=[];for(var i=0;i<9;i++){for(var o=[],r=0;r<9;r++)o.push({});this._createBoard.push(o)}this._unsetPieces={FU:18,KY:4,KE:4,GI:4,KI:4,KA:2,HI:2,OU:2},this._createHands=[{},{}],this._setKomaKind=null,this.stateMachine.editBoard()},t.prototype.switch_EDITMOVE=function(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null),t&&(this._headerInfo.detail=t),e&&(this._headerInfo.proponent_name=e),i&&(this._headerInfo.opponent_name=i),r&&(this._headerInfo.place=r);var n={preset:this.initBoardPreset};"OTHER"===this.initBoardPreset&&(n.data={board:this._createBoard,color:o.PLAYER.SENTE,hands:this._createHands});var s={header:this._headerInfo,initial:n,moves:[{}]};this.jkfEditor.load(s),this.stateMachine.editMove()},t.prototype.switch_EDITMOVEfromLOADKIFU=function(t){this.load(t),this.stateMachine.editMove()},t.prototype.edit_inputFrom=function(t,e,i){this.editState===o.EDITSTATE.INPUTFROM?(this.fromX=t,this.fromY=e,this.fromKind=i,this.editStateMachine.inputTo()):console.log("INPUTFROM状態以外ではFROM座標の入力はできません。")},t.prototype.edit_inputTo=function(t,e,i){if(void 0===i&&(i=!1),this.editState===o.EDITSTATE.INPUTTO)if(this._toX=t,this._toY=e,-1!==this.fromX&&-1!==this.fromY){var n=this.jkfEditor.getBoardPiece(this.fromX,this.fromY);r.default.isPromotable(this.fromY,this.toY,n.color,n.kind)?i?(this.jkfEditor.addBoardMove(this.fromX,this.fromY,this.toX,this.toY,!0),this.jkfEditor.currentNum++,this.editStateMachine.inputFrom()):this.editStateMachine.inputNari():(this.jkfEditor.addBoardMove(this.fromX,this.fromY,this.toX,this.toY),this.isOpenFork&&(this.jkfEditor.switchFork(this.jkfEditor.nextMoves.length-1),this.isOpenFork=!1),this.jkfEditor.currentNum++,this.editStateMachine.inputFrom())}else this.jkfEditor.addHandMove(this.fromKind,this.toX,this.toY),this.isOpenFork&&(this.jkfEditor.switchFork(this.jkfEditor.nextMoves.length-1),this.isOpenFork=!1),this.jkfEditor.currentNum++,this.editStateMachine.inputFrom();else console.log("INPUTTO状態以外ではTO座標の入力はできません。")},t.prototype.edit_inputNari=function(t){this.editState===o.EDITSTATE.INPUTNARI&&(t?this.jkfEditor.addBoardMove(this.fromX,this.fromY,this.toX,this.toY,!0):this.jkfEditor.addBoardMove(this.fromX,this.fromY,this.toX,this.toY),this.jkfEditor.currentNum++,this.editStateMachine.inputFrom())},t.prototype.edit_inputReset=function(t){void 0===t&&(t=!1),t||this.jkfEditor.currentNum===this.jkfEditor.moves.length-1?this.editStateMachine.inputFrom():this.editStateMachine.inputReset()},t.prototype.create_inputKind=function(t){this._setKomaKind=t,this.createStateMachine.inputPos()},t.prototype.create_inputPos=function(t,e){this.setCreateBoard(t,e,this.setKomaKind),this.unsetPieces[this.setKomaKind]||this.create_inputReset()},t.prototype.create_komaEdit=function(t,e){this._editX=t,this._editY=e,this.createStateMachine.komaEdit(),this._setKomaKind=null},t.prototype.create_inputReset=function(){this._setKomaKind=null,this._editX=null,this._editY=null,this.createStateMachine.inputKind()},t.prototype.addForkMove=function(){this.editState===o.EDITSTATE.NOINPUT&&this.edit_inputReset(!0)},t.prototype.go=function(t){this.jkfEditor.go(t),this.state===o.STATE.EDITMOVE&&this.edit_inputReset()},t.prototype.deleteMove=function(t){this.jkfEditor.deleteMove(t),this.go(t-1)},Object.defineProperty(t.prototype,"state",{get:function(){return"string"==typeof this.stateMachine.state?this.stateMachine.state:"ERROR"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editState",{get:function(){return this.state===o.STATE.EDITMOVE&&"string"==typeof this.editStateMachine.state?this.editStateMachine.state:"ERROR"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"createState",{get:function(){return this.state===o.STATE.EDITBOARD&&"string"==typeof this.createStateMachine.state?this.createStateMachine.state:"ERROR"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return this._headerInfo.title?this._headerInfo.title:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"detail",{get:function(){return this._headerInfo.detail?this._headerInfo.detail:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"proponent_name",{get:function(){return this._headerInfo.proponent_name?this._headerInfo.proponent_name:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"opponent_name",{get:function(){return this._headerInfo.opponent_name?this._headerInfo.opponent_name:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"place",{get:function(){return this._headerInfo.place?this._headerInfo.place:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kifuType",{get:function(){return this._kifuType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReverse",{get:function(){return this._isReverse},set:function(t){this._isReverse=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maskArray",{get:function(){return this.isReverse?this._reverseMaskArray:this._maskArray},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"toX",{get:function(){return this._toX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"toY",{get:function(){return this._toY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isOpenFork",{get:function(){return this._isOpenFork},set:function(t){this._isOpenFork=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isOpenInfo",{get:function(){return this._isOpenInfo},set:function(t){this._isOpenInfo=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"unsetPieces",{get:function(){return this._unsetPieces},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"setKomaKind",{get:function(){return this._setKomaKind},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editX",{get:function(){return this._editX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editY",{get:function(){return this._editY},enumerable:!0,configurable:!0}),t.prototype.load=function(t){t.hasOwnProperty("header")?this._headerInfo=t.header:t.header=this._headerInfo,t.hasOwnProperty("moves")||(t.moves=[]),this.jkfEditor.load(t)},t.prototype.export=function(){var t=this.jkfEditor.export(),e="data:application/octet-stream,"+encodeURIComponent(JSON.stringify(t));this.downloadURI(e,"jkf.json")},t.prototype.switchFork=function(t){this.jkfEditor.switchFork(t),this.isOpenFork=!1},t.prototype.deleteFork=function(t){this.jkfEditor.deleteFork(t)},t.prototype.haveFork=function(t){return this.jkfEditor.haveFork(t)},Object.defineProperty(t.prototype,"board",{get:function(){return this.state===o.STATE.EDITBOARD||this.state===o.STATE.EDITINFO&&"OTHER"===this.initBoardPreset?this._createBoard:this.isReverse?this.jkfEditor.reverseBoard:this.jkfEditor.board},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentNum",{get:function(){return this.jkfEditor.currentNum},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hands",{get:function(){return this.state===o.STATE.EDITBOARD?this._createHands:this.jkfEditor.hands},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.jkfEditor.color},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"moves",{get:function(){return this.jkfEditor.moves},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"forks",{get:function(){return this.jkfEditor.nextMoves},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"forkIndex",{get:function(){return this.jkfEditor.nextSelect},enumerable:!0,configurable:!0}),t.prototype.setHeader=function(t,e){this.state===o.STATE.EDITMOVE&&(this._headerInfo[t]=e)},t.prototype.setMask=function(t){this._maskArray=t,this._reverseMaskArray=r.default.reverseBoard(t)},t.prototype.downloadURI=function(t,e){var i=document.createElement("a");i.download=e,i.href=t,document.body.appendChild(i),i.click(),document.body.removeChild(i)},t.prototype.createMask=function(t){return t.map(function(t){return t.map(function(t){return t.kind?1:0})})},t.prototype.setCreateBoard=function(t,e,i){if(this.unsetPieces[i]){var r=9-t,n=e-1;this._createBoard[n][r].kind||(this.unsetPieces[i]--,this.unsetPieces[i]||delete this.unsetPieces[i],this._createBoard[n][r]={kind:i,color:o.PLAYER.SENTE})}this.setMask(this.createMask(this._createBoard))},t.prototype.unsetCreateBoard=function(t,e){var i=9-t,o=e-1;if(this._createBoard[o][i].kind){var n=r.default.getDemote(this._createBoard[o][i].kind);this.unsetPieces[n]=this.unsetPieces[n]?this.unsetPieces[n]+1:1,this._createBoard[o][i]={}}this.setMask(this.createMask(this._createBoard))},t.prototype.switchColorCreateBoard=function(t,e){var i=9-t,r=e-1;this._createBoard[r][i].kind&&(this._createBoard[r][i].color=this._createBoard[r][i].color===o.PLAYER.SENTE?o.PLAYER.GOTE:o.PLAYER.SENTE)},t.prototype.switchNariCreateBoard=function(t,e){var i=9-t,o=e-1;this._createBoard[o][i].kind&&(this._createBoard[o][i].kind=r.default.canPromote(this._createBoard[o][i].kind)?r.default.getPromote(this._createBoard[o][i].kind):r.default.getDemote(this._createBoard[o][i].kind))},t.prototype.addHandCreateBoard=function(t,e){this.unsetPieces[e]&&(this._createHands[t][e]=this._createHands[t][e]?this._createHands[t][e]+1:1,this.unsetPieces[e]--,this.unsetPieces[e]||delete this.unsetPieces[e])},t.prototype.removeHandCreateBoard=function(t,e){this._createHands[t][e]&&(this._createHands[t][e]--,this._createHands[t][e]||delete this._createHands[t][e],this.unsetPieces[e]=this.unsetPieces[e]?this.unsetPieces[e]+1:1)},t}();exports.default=n;
},{"jkfeditor":136,"@taoqf/javascript-state-machine":135,"./const":132,"./util":134}],133:[function(require,module,exports) {
!function(){"use strict";var e={}.hasOwnProperty;function n(){for(var r=[],t=0;t<arguments.length;t++){var f=arguments[t];if(f){var o=typeof f;if("string"===o||"number"===o)r.push(f);else if(Array.isArray(f)&&f.length){var i=n.apply(null,f);i&&r.push(i)}else if("object"===o)for(var a in f)e.call(f,a)&&f[a]&&r.push(a)}}return r.join(" ")}"undefined"!=typeof module&&module.exports?(n.default=n,module.exports=n):"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("classnames",[],function(){return n}):window.classNames=n}();
},{}],131:[function(require,module,exports) {
"use strict";exports.__esModule=!0;var t=function(){function t(t){this.appData=t}return t.getInstance=function(t,n){return null==this._instance?this._instance=new t(n):this._instance.appdata=n,this._instance},t.prototype.view=function(t){return[]},t}();exports.default=t;
},{}],137:[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,a){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(e,a)};return function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var a=e(require("mithril")),n=e(require("classNames")),o=e(require("../util")),i=e(require("../singleComponentBasic")),r=require("../const"),u=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.hoverX=-1,t.hoverY=-1,t}return t(i,e),i.prototype.view=function(t){var e=this,i=o.default.getAttr(t,"kind"),u=o.default.getAttr(t,"color")?o.default.getAttr(t,"color"):0,p=o.default.getAttr(t,"komaNum")?o.default.getAttr(t,"komaNum"):1,s=o.default.getAttr(t,"dispType")?o.default.getAttr(t,"dispType"):r.KOMATYPE.NORMAL,c=o.default.getAttr(t,"posX"),l=o.default.getAttr(t,"posY"),f=o.default.getAttr(t,"forcePromote"),d=o.default.getAttr(t,"setTarget"),_=o.default.getAttr(t,"isUnset"),h=!1,D=!1,T=!1,A={},m=null,E=null,v=null,P=null;return s===r.KOMATYPE.FROM?(m="is-blue",E=function(){e.appData.edit_inputFrom(c,l,i)}):s===r.KOMATYPE.TO?(m="is-red",E=function(){e.appData.edit_inputTo(c,l,f)}):s===r.KOMATYPE.NORMAL?(d&&(m="is-green"),this.appData.state===r.STATE.EDITMOVE?E=function(){e.appData.edit_inputReset()}:this.appData.state===r.STATE.EDITBOARD&&(_?E=function(){d?e.appData.create_inputReset():e.appData.create_inputKind(i)}:-1===c&&-1===l?this.appData.createState===r.CREATESTATE.INPUTKIND&&(m="is-blue",E=function(){e.appData.removeHandCreateBoard(u,i),e.appData.hands[i]&&e.appData.create_inputReset()}):(this.appData.createState===r.CREATESTATE.INPUTKIND&&(T=!0,c===this.hoverX&&l===this.hoverY&&i&&(m="is-blue",D=!0)),E=function(){e.appData.createState===r.CREATESTATE.INPUTKIND?e.appData.create_komaEdit(c,l):(e.setHover(c,l),e.appData.create_inputReset())}))):s===r.KOMATYPE.KIND?(m="is-blue",E=function(){e.appData.create_inputKind(i)}):s===r.KOMATYPE.POS?(T=!0,E=function(){e.appData.create_inputPos(c,l)},c!==this.hoverX||l!==this.hoverY||i||(i=this.appData.setKomaKind,h=!0)):s===r.KOMATYPE.EDIT&&(E=function(){}),T?(v=function(){e.setHover(c,l)},P=function(){e.setHover(-1,-1)}):this.setHover(-1,-1),A.class=n.default(m),E&&(A.onclick=E),v&&(A.onmouseenter=v),P&&(A.onmouseleave=P),[a.default(".c-koma_piece_base",A,[s===r.KOMATYPE.EDIT?a.default(".c-koma_menu_container",[a.default(".c-koma_half_button.is-change",{onclick:function(t){e.appData.switchColorCreateBoard(c,l),e.appData.create_inputReset(),t.stopPropagation()}},u!==r.PLAYER.SENTE?"先手":"後手"),a.default(".c-koma_half_button.is-nari",{onclick:function(t){e.appData.switchNariCreateBoard(c,l),e.appData.create_inputReset(),t.stopPropagation()}},o.default.isPromoted(i)?"不成":"成り")]):null,s===r.KOMATYPE.PROMOTE?a.default(".c-koma_menu_container",[a.default(".c-koma_half_button.is-nari",{onclick:function(){e.appData.edit_inputNari(!0)}},"成"),a.default(".c-koma_half_button.is-funari",{onclick:function(){e.appData.edit_inputNari(!1)}},"不成")]):null,D?a.default(".c-koma_menu_container",[a.default(".delete.is-small",{onclick:function(t){e.appData.unsetCreateBoard(c,l),t.stopPropagation()}})]):null,p>1?a.default(".c-koma_piece_num",p):null,a.default(".c-koma_piece",{class:n.default(i?o.default.komaClassName(i,u,this.appData.isReverse):null,!!h&&"is-ready")})])]},i.prototype.setHover=function(t,e){this.hoverX=t,this.hoverY=e},i}(i.default);exports.default=u;
},{"mithril":13,"classNames":133,"../util":134,"../singleComponentBasic":131,"../const":132}],92:[function(require,module,exports) {
"use strict";var a=this&&this.__extends||function(){var a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,t){a.__proto__=t}||function(a,t){for(var e in t)t.hasOwnProperty(e)&&(a[e]=t[e])})(t,e)};return function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),t=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};exports.__esModule=!0;var e=t(require("mithril")),n=t(require("classNames")),o=t(require("./koma")),i=t(require("../singleComponentBasic")),p=require("../const"),s=t(require("../util")),r=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return a(i,t),i.prototype.oninit=function(){this.koma=o.default.getInstance(o.default,this.appData),this.handArray=[],this.handArray[p.PLAYER.SENTE]=[[]]},i.prototype.view=function(){var a=this;return[e.default(".c-shogiBan_koma",[e.default(".c-shogiBan",this.appData.board.map(function(t,n){return e.default(".c-koma_row",t.map(function(t,o){var i=a.getBoardKomaProp(t.kind,t.color,o,n);return e.default(a.koma,i)}))})),e.default(".c-shogiBan_hand_place",[e.default(".c-shogiBan_hand.c-shogiBan_oppo_hand",[this.appData.state===p.STATE.EDITBOARD?[e.default(".c-shogiBan_hand_pieces.is-oppoHands",{class:n.default(this.goteHandHover?"is-adding":null),onclick:function(){a.appData.createState===p.CREATESTATE.INPUTPOS&&(a.appData.addHandCreateBoard(p.PLAYER.GOTE,a.appData.setKomaKind),a.appData.unsetPieces[a.appData.setKomaKind]||a.appData.create_inputReset())}},[e.default(".c-shogiBan_hand_pieces_inner",[this.getHand(this.appData.hands[p.PLAYER.GOTE]).map(function(t){return e.default("div.c-koma_row",[Object.keys(t).map(function(n){var o=a.getHandKomaProp(n,p.PLAYER.GOTE,t[n]);return e.default(a.koma,o)})])})]),e.default(".c-shogiBan_hand_owner",{onmouseenter:function(){a.appData.setKomaKind&&(a.goteHandHover=!0)},onmouseleave:function(){a.goteHandHover=!1}},this.goteHandHover?"初期持ち駒追加":"後手持ち駒")]),e.default(".c-shogiBan_hand_pieces.is-propHands",{class:n.default(this.senteHandHover?"is-adding":null),onclick:function(){a.appData.createState===p.CREATESTATE.INPUTPOS&&(a.appData.addHandCreateBoard(p.PLAYER.SENTE,a.appData.setKomaKind),a.appData.unsetPieces[a.appData.setKomaKind]||a.appData.create_inputReset())}},[e.default(".c-shogiBan_hand_pieces_inner",[this.getHand(this.appData.hands[p.PLAYER.SENTE]).map(function(t){return e.default("div.c-koma_row",[Object.keys(t).map(function(n){var o=a.getHandKomaProp(n,p.PLAYER.SENTE,t[n]);return e.default(a.koma,o)})])})]),e.default(".c-shogiBan_hand_owner",{onmouseenter:function(){a.appData.setKomaKind&&(a.senteHandHover=!0)},onmouseleave:function(){a.senteHandHover=!1}},this.senteHandHover?"初期持ち駒追加":"先手持ち駒")])]:e.default(".c-shogiBan_hand_pieces",[this.getHand(this.appData.hands[p.PLAYER.GOTE]).map(function(t){return e.default("div.c-koma_row",[Object.keys(t).map(function(n){var o=a.getHandKomaProp(n,p.PLAYER.GOTE,t[n]);return e.default(a.koma,o)})])})]),e.default(".c-shogiBan_hand_base")]),e.default(".c-shogiBan_hand",{class:n.default("c-shogiBan_prop_hand")},[this.appData.state===p.STATE.EDITBOARD?[e.default(".c-shogiBan_hand_pieces",[this.getHand(this.appData.unsetPieces).map(function(t){return e.default("div.c-koma_row",[Object.keys(t).map(function(n){var o=a.getUnsetKomaProp(n,p.PLAYER.SENTE,t[n]);return e.default(a.koma,o)})])})]),e.default(".c-shogiBan_hand_pieces.is-button",e.default(".c-shogiBan_createButton",e.default(".button.is-primary",{onclick:function(){a.appData.switch_EDITINFO(p.BAN.CUSTOM)}},"盤面編集完了")))]:e.default(".c-shogiBan_hand_pieces",[this.getHand(this.appData.hands[p.PLAYER.SENTE]).map(function(t){return e.default(".c-koma_row",[Object.keys(t).map(function(n){var o=a.getHandKomaProp(n,p.PLAYER.SENTE,t[n]);return e.default(a.koma,o)})])})]),e.default(".c-shogiBan_hand_base")])])]),e.default(".c-shogiBan_grid",{class:n.default(this.appData.isReverse?"is-reverse":null)})]},i.prototype.getHand=function(a){var t=[],e=0,n=null;return Object.keys(a).forEach(function(o){if(0===e){n={}}n[o]=a[o],4===++e&&(t.push(n),n=null,e=0)}),n&&Object.keys(n).length&&t.push(n),t},i.prototype.getBoardKomaProp=function(a,t,e,n){var o=s.default.getKifuPos(e,n,this.appData.isReverse),i={kind:a,color:t,komaNum:1,dispType:p.KOMATYPE.NORMAL,posX:o.x,posY:o.y};return this.appData.state===p.STATE.EDITMOVE?this.appData.maskArray[n][e]&&(this.appData.editState===p.EDITSTATE.INPUTFROM?i.dispType=p.KOMATYPE.FROM:this.appData.editState===p.EDITSTATE.INPUTTO?(i.dispType=p.KOMATYPE.TO,2===this.appData.maskArray[n][e]&&(i.forcePromote=!0)):this.appData.editState===p.EDITSTATE.INPUTNARI&&this.appData.toX===o.x&&this.appData.toY===o.y&&(i.dispType=p.KOMATYPE.PROMOTE)):this.appData.state===p.STATE.EDITBOARD&&(this.appData.createState===p.CREATESTATE.KOMAEDIT?this.appData.editX===o.x&&this.appData.editY===o.y&&(i.dispType=p.KOMATYPE.EDIT):this.appData.maskArray[n][e]||(i.dispType=p.KOMATYPE.POS)),i},i.prototype.getHandKomaProp=function(a,t,e){void 0===e&&(e=1);var n={kind:a,color:t,komaNum:e,dispType:p.KOMATYPE.NORMAL,posX:-1,posY:-1};return this.appData.state===p.STATE.EDITMOVE?this.appData.editState===p.EDITSTATE.INPUTFROM&&t===s.default.oppoPlayer(this.appData.color)&&(n.dispType=p.KOMATYPE.FROM):(this.appData.state,p.STATE.EDITBOARD),n},i.prototype.getUnsetKomaProp=function(a,t,e){void 0===e&&(e=1);var n={kind:a,color:t,komaNum:e,dispType:p.KOMATYPE.NORMAL,posX:-1,posY:-1,isUnset:!0};return this.appData.state===p.STATE.EDITBOARD&&(this.appData.createState===p.CREATESTATE.INPUTKIND?n.dispType=p.KOMATYPE.KIND:this.appData.createState===p.CREATESTATE.INPUTPOS&&a===this.appData.setKomaKind&&(n.setTarget=!0)),n},i}(i.default);exports.default=r;
},{"mithril":13,"classNames":133,"./koma":137,"../singleComponentBasic":131,"../const":132,"../util":134}],93:[function(require,module,exports) {
"use strict";var a=this&&this.__extends||function(){var a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,t){a.__proto__=t}||function(a,t){for(var e in t)t.hasOwnProperty(e)&&(a[e]=t[e])})(t,e)};return function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),t=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};exports.__esModule=!0;var e=t(require("mithril")),i=t(require("classNames")),u=t(require("../singleComponentBasic")),n=require("../const"),f=function(t){function u(){return null!==t&&t.apply(this,arguments)||this}return a(u,t),u.prototype.view=function(){var a=this;return[e.default(".c-kifu_container",[e.default(".c-kifu_title",this.appData.title),e.default(".c-kifu_listContainer",[e.default(".c-kifu_list",{onupdate:function(t){var e=24*a.appData.currentNum;t.dom.scrollTop=e-480}},[this.appData.moves.map(function(t,u){var f=!1;u===a.appData.currentNum&&(f=!0);var l=!1;a.appData.state===n.STATE.VIEW&&t.comments&&(l=!0);var o=!1;a.appData.kifuType===n.KIFUTYPE.JOSEKI?u!==a.appData.moves.length-1&&(f||a.appData.haveFork(u))&&(o=!0):a.appData.haveFork(u)&&(o=!0);var c=!1;return a.appData.state===n.STATE.EDITMOVE&&u===a.appData.currentNum&&0!==u&&(c=!0),e.default(".c-kifu_row",{class:i.default(f?"is-active":null),onclick:function(){f||a.appData.go(u)}},[e.default(".c-kifu_move_info",[e.default(".c-kifu_number",u+":"),e.default(".c-kifu_move",{class:i.default(t.name.length>=6?"is-small":null)},t.name),e.default(".c-kifu_notation",[l?e.default("span",{class:i.default("c-kifu_notation_comment","icon","is-small")},[e.default("i.fa.fa-commenting-o")]):null,o?e.default("span.c-kifu_notation_branch.icon.is-small",{onclick:function(){a.appData.isOpenFork=!0}},[e.default("i.far.fa-clone")]):null,c?e.default("span.c-kifu_notation_close.icon.is-small",{onclick:function(){a.appData.deleteMove(u)}},[e.default("i.fa.fa-times.fa-lg")]):null])])])})]),e.default(".c-kifu_fork",{class:i.default(this.appData.isOpenFork?"is-active":null)},[e.default(".c-kifu_select",[e.default(".c-kifu_move_info",[e.default(".c-kifu_forkTitle","次の指し手候補"),e.default(".c-kifu_notation",[e.default("span",{onclick:function(){a.appData.isOpenFork=!1}},e.default("i.fa.fa-times.fa-lg"))])])]),this.appData.forks.map(function(t,u){var f=a.appData.state===n.STATE.EDITMOVE&&a.appData.forks.length>1&&u!==a.appData.forkIndex;return e.default(".c-kifu_row.c-kifu_forkRow",{class:a.appData.forkIndex===u?"is-active":null,onclick:function(){a.appData.switchFork(u)}},e.default(".c-kifu_move_info",[e.default("div",{class:i.default("c-kifu_number")},u+":"),e.default("div",{class:i.default("c-kifu_move")},t.name),f?e.default(".c-kifu_notation",[e.default("span.c-kifu_notation_close.icon.is-small",{onclick:function(t){a.appData.deleteFork(u),t.stopPropagation()}},e.default("i.fa.fa-times.fa-lg"))]):null]))}),e.default(".c-kifu_row.c-kifu_addRow",{onclick:function(){a.appData.addForkMove()}},e.default(".c-kifu_move_info",[this.appData.editState===n.EDITSTATE.INPUTFROM?[e.default("div",{class:i.default("c-kifu_number")},e.default("span.icon.is-small",e.default("i.fa.fa-exclamation-circle"))),e.default("div.c-kifu_move.c-kifu_move_input","分岐を入力して下さい")]:[e.default("div",{class:i.default("c-kifu_number")},e.default("span.icon.is-small",e.default("i.fa.fa-plus"))),e.default("div.c-kifu_move","分岐を追加")]]))]),e.default(".c-kifu_blackOut",{class:i.default(this.appData.isOpenFork?"is-active":null)})])])]},u}(u.default);exports.default=f;
},{"mithril":13,"classNames":133,"../singleComponentBasic":131,"../const":132}],142:[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var r=e(require("mithril")),o=e(require("classNames")),i=e(require("../singleComponentBasic")),n=e(require("../util")),u=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return t(i,e),i.prototype.view=function(t){var e=n.default.getAttr(t,"title")?n.default.getAttr(t,"title"):"ボタン名",i=n.default.getAttr(t,"iconClass"),u=n.default.getAttr(t,"isActive"),l=n.default.getAttr(t,"action"),a=(n.default.getAttr(t,"isSmall"),n.default.getAttr(t,"color"));return[r.default("button.button.is-tooltip-info",{disabled:!u,onclick:l,"data-tooltip":e,class:o.default(a,u?"tooltip":null)},[r.default("span.icon",r.default("i.fa",{class:i}))])]},i}(i.default);exports.default=u;
},{"mithril":13,"classNames":133,"../singleComponentBasic":131,"../util":134}],94:[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(a,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,a){t.__proto__=a}||function(t,a){for(var e in a)a.hasOwnProperty(e)&&(t[e]=a[e])})(a,e)};return function(a,e){function o(){this.constructor=a}t(a,e),a.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var e=a(require("mithril")),o=a(require("classNames")),i=a(require("../singleComponentBasic")),n=a(require("./toolButton")),s=require("../const"),u=function(a){function i(){return null!==a&&a.apply(this,arguments)||this}return t(i,a),i.prototype.oninit=function(){this.toolButton=n.default.getInstance(n.default,this.appData)},i.prototype.view=function(){var t=this;return[e.default(".c-tool_comment","初期盤面新規作成"),e.default(".c-tool_button",[e.default(".c-tool_button_container",[e.default(this.toolButton,{title:"一番最初へ",iconClass:o.default("fa-fast-backward"),action:function(){t.appData.go(0)},isActive:!!this.appData.currentNum}),e.default(this.toolButton,{title:"一つ戻る",iconClass:o.default("fa-chevron-left"),action:function(){t.appData.go(t.appData.currentNum-1)},isActive:!!this.appData.currentNum}),e.default(this.toolButton,{title:"一つ進む",iconClass:o.default("fa-chevron-right"),action:function(){t.appData.go(t.appData.currentNum+1)},isActive:this.appData.currentNum<this.appData.moves.length-1}),e.default(this.toolButton,{title:"一番最後へ",iconClass:o.default("fa-fast-forward"),action:function(){t.appData.go(t.appData.moves.length-1)},isActive:this.appData.currentNum<this.appData.moves.length-1})]),e.default(".c-tool_button_container",[e.default(this.toolButton,{title:"先後交代",iconClass:o.default("fa-exchange-alt","fa-rotate-90"),action:function(){t.appData.isReverse=!t.appData.isReverse},isActive:this.appData.state!==s.STATE.EDITBOARD,color:this.appData.isReverse?"is-danger":null}),e.default(this.toolButton,{title:"棋譜情報表示",iconClass:o.default("fa-info-circle"),action:function(){t.appData.isOpenInfo=!t.appData.isOpenInfo},isActive:this.appData.state===s.STATE.EDITMOVE||this.appData.state===s.STATE.VIEW,color:this.appData.isOpenInfo?"is-danger":null}),e.default(this.toolButton,{title:"jkfエクスポート",iconClass:o.default("fa-file-export"),action:function(){t.appData.export()},isActive:this.appData.state===s.STATE.EDITMOVE||this.appData.state===s.STATE.VIEW})])])]},i}(i.default);exports.default=u;
},{"mithril":13,"classNames":133,"../singleComponentBasic":131,"./toolButton":142,"../const":132}],138:[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var e=n(require("mithril")),o=n(require("../../singleComponentBasic")),i=function(n){function o(){return null!==n&&n.apply(this,arguments)||this}return t(o,n),o.prototype.view=function(){var t=this;return[e.default("label.label.is-main.c-shogiBan_menu_label","JKFEdit Menu"),e.default(".field.c-shogiBan_menu_button",[e.default(".control.button.is-primary",{onclick:function(){t.appData.switch_NEWKIFU()}},"棋譜の新規作成")]),e.default(".field.c-shogiBan_menu_button",[e.default(".control.button.is-primary",{onclick:function(){t.appData.switch_LOADKIFU()}},"棋譜の読み込み")])]},o}(o.default);exports.default=i;
},{"mithril":13,"../../singleComponentBasic":131}],139:[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function i(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(i.prototype=a.prototype,new i)}}(),t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};exports.__esModule=!0;var a=t(require("mithril")),i=require("../../const"),o=t(require("../../util")),l=t(require("../../singleComponentBasic")),n=function(t){function l(){return null!==t&&t.apply(this,arguments)||this}return e(l,t),l.prototype.oninit=function(){this.kifuTitle="",this.boardType=0,this.komaochiType=0,this.kifuType=0},l.prototype.view=function(){var e=this;return[a.default("label.label.c-shogiBan_menu_label.is-main","新規作成"),a.default(".field.c-shogiBan_menu_option",[a.default("label.label.c-shogiBan_menu_label","タイトル(必須)"),a.default(".field",a.default(".control",[a.default("input.input.is-primary",{maxlength:32,type:"text",value:this.kifuTitle,placeholder:"棋譜タイトルを入力",oninput:a.default.withAttr("value",function(t){e.kifuTitle=t})})])),a.default("label.label.c-shogiBan_menu_label","初期盤面"),a.default(".control",[a.default(".select",[a.default("select",{selected:this.boardType,onchange:a.default.withAttr("selectedIndex",function(t){switch(e.boardType=t,e.boardType){case i.BAN.HIRATE:e.appData.load({header:{},initial:{preset:"HIRATE"},moves:[{}]});break;case i.BAN.KOMAOCHI:e.appData.load({header:{},initial:{preset:"KY"},moves:[{}]});break;case i.BAN.CUSTOM:e.appData.load({header:{},initial:{preset:"HIRATE"},moves:[{}]})}})},[a.default("option","平手"),a.default("option","駒落ち"),a.default("option","カスタム")])])])]),this.boardType===i.BAN.KOMAOCHI?[a.default(".c-shogiBan_menu_komaochi.field",[a.default("label.label.c-shogiBan_menu_label","駒落ち詳細")]),a.default(".field.c-shogiBan_menu_option",[a.default(".control",[a.default(".select",[a.default("select",{selected:this.komaochiType,onchange:a.default.withAttr("selectedIndex",function(t){e.komaochiType=t,e.appData.load({header:{},initial:{preset:o.default.komaochiName(e.komaochiType)},moves:[{}]})})},[a.default("option","香落ち"),a.default("option","角落ち"),a.default("option","飛車落ち"),a.default("option","飛香落ち"),a.default("option","二枚落ち"),a.default("option","四枚落ち"),a.default("option","六枚落ち"),a.default("option","八枚落ち")])])])])]:null,a.default(".field.c-shogiBan_menu_option",[a.default("label.label.c-shogiBan_menu_label","入力形式"),a.default(".control",[a.default(".select",[a.default("select",{selected:this.kifuType,onchange:a.default.withAttr("selectedIndex",function(t){e.kifuType=t})},[a.default("option","棋譜"),a.default("option","定跡")])])])]),a.default(".field.c-shogiBan_menu_button",[a.default(".control",[this.boardType===i.BAN.CUSTOM?a.default("button.button.is-danger",{disabled:!this.kifuTitle,onclick:function(){e.appData.switch_EDITBOARD(e.kifuTitle,e.kifuType)}},"盤面入力へ"):a.default("button.button.is-primary",{disabled:!this.kifuTitle,onclick:function(){e.appData.switch_EDITINFO(e.boardType,e.kifuTitle,e.komaochiType,e.kifuType)}},"棋譜情報入力へ")])])]},l}(l.default);exports.default=n;
},{"mithril":13,"../../const":132,"../../util":134,"../../singleComponentBasic":131}],140:[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};exports.__esModule=!0;var a=t(require("mithril")),n=t(require("classNames")),l=t(require("../../singleComponentBasic")),i=function(t){function l(){return null!==t&&t.apply(this,arguments)||this}return e(l,t),l.prototype.oninit=function(){this.dispPlayerName=!1,this.proponentName="",this.opponentName="",this.place="",this.detail="",this.dispPlaceName=!1},l.prototype.view=function(){var e=this;return[a.default("label.label.is-main.c-shogiBan_menu_label","棋譜情報入力"),a.default(".field.c-shogiBan_menu_option",[a.default("label.label.c-shogiBan_menu_label.c-shogiBan_menu_expandOpton",{onclick:function(){e.dispPlayerName=!e.dispPlayerName}},a.default("span.icon.is-small",[a.default("i.fa.fa-chevron-right",{class:n.default(this.dispPlayerName?"is-open":null)})]),"対局者名"),this.dispPlayerName?[a.default(".field",a.default(".control",[a.default("input.input.is-primary",{type:"text",value:this.proponentName,placeholder:"先手",oninput:a.default.withAttr("value",function(t){e.proponentName=t})})])),a.default(".field",a.default(".control",[a.default("input.input.is-primary",{type:"text",value:this.opponentName,placeholder:"後手",oninput:a.default.withAttr("value",function(t){e.opponentName=t})})]))]:null,a.default(".field.c-shogiBan_menu_option",[a.default("label.label.c-shogiBan_menu_label.c-shogiBan_menu_expandOpton",{onclick:function(){e.dispPlaceName=!e.dispPlaceName}},a.default("span.icon.is-small",[a.default("i.fa.fa-chevron-right",{class:n.default(this.dispPlaceName?"is-open":null)})]),"棋戦名"),this.dispPlaceName?[a.default(".field",a.default(".control",[a.default("input.input.is-primary",{type:"text",value:this.place,placeholder:"棋戦名",oninput:a.default.withAttr("value",function(t){e.place=t})})]))]:null]),a.default(".field.c-shogiBan_menu_option",[a.default("label.label.c-shogiBan_menu_label.c-shogiBan_menu_expandOpton","棋譜詳細(必須)"),a.default(".field",a.default(".control",[a.default("textarea.textarea.is-primary",{value:this.detail,placeholder:"棋譜詳細を入力\n(最大140文字)",maxlength:140,oninput:a.default.withAttr("value",function(t){e.detail=t})})]))]),a.default(".field.c-shogiBan_menu_button",[a.default(".control",[a.default("button.button.is-primary",{disabled:!this.detail,onclick:function(){e.appData.switch_EDITMOVE(e.detail,e.proponentName,e.opponentName,e.place)}},"棋譜編集開始")])])])]},l}(l.default);exports.default=i;
},{"mithril":13,"classNames":133,"../../singleComponentBasic":131}],141:[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};exports.__esModule=!0;var a=t(require("mithril")),n=t(require("../../singleComponentBasic")),r=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.view=function(e){var t=this;return[a.default("label.label.is-main.c-shogiBan_menu_label","棋譜の読み込み"),a.default(".field.c-shogiBan_menu_button",{ondragover:function(e){e.stopPropagation(),e.preventDefault()},ondrop:function(e){e.stopPropagation();var n=e.dataTransfer.files[0];if(n){var r=new FileReader;r.onload=function(e){var n=JSON.parse(e.target.result);t.appData.switch_EDITMOVEfromLOADKIFU(n),a.default.redraw()},r.readAsText(n)}e.preventDefault()}},[a.default(".file.is-boxed.is-danger",a.default("label.file-label",[a.default("input.file-input[name='resume'][type='file']",{onchange:a.default.withAttr("files",function(e){var n=e[0];if(n){var r=new FileReader;r.onload=function(e){var n=JSON.parse(e.target.result);t.appData.switch_EDITMOVEfromLOADKIFU(n),a.default.redraw()},r.readAsText(n)}})}),a.default("span.file-cta",[a.default("span.file-icon",a.default("i.fas.fa-upload")),a.default("span.file-label","jkfファイルを選択…")])]))])]},n}(n.default);exports.default=r;
},{"mithril":13,"../../singleComponentBasic":131}],95:[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,a){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(e,a)};return function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var a=e(require("mithril")),n=e(require("./menu/topMenu")),u=require("../const"),i=e(require("./menu/newKifuMenu")),s=e(require("./menu/kifuInfoMenu")),o=e(require("../singleComponentBasic")),r=e(require("./menu/loadKifuMenu")),p=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return t(o,e),o.prototype.oninit=function(){this.topMenu=n.default.getInstance(n.default,this.appData),this.newKifuMenu=i.default.getInstance(i.default,this.appData),this.kifuInfoMenu=s.default.getInstance(s.default,this.appData),this.loadKifuMenu=r.default.getInstance(r.default,this.appData)},o.prototype.view=function(){return[this.appData.state===u.STATE.TOP||this.appData.state===u.STATE.NEWKIFU||this.appData.state===u.STATE.EDITINFO||this.appData.state===u.STATE.LOADKIFU?a.default(".c-shogiBan_menu_place",[a.default(".c-shogiBan_menu_base",[this.appData.state===u.STATE.TOP?a.default(this.topMenu):null,this.appData.state===u.STATE.NEWKIFU?a.default(this.newKifuMenu):null,this.appData.state===u.STATE.EDITINFO?a.default(this.kifuInfoMenu):null,this.appData.state===u.STATE.LOADKIFU?a.default(this.loadKifuMenu):null])]):null]},o}(o.default);exports.default=p;
},{"mithril":13,"./menu/topMenu":138,"../const":132,"./menu/newKifuMenu":139,"./menu/kifuInfoMenu":140,"../singleComponentBasic":131,"./menu/loadKifuMenu":141}],96:[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,a){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(e,a)};return function(e,a){function l(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(l.prototype=a.prototype,new l)}}(),e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var a=e(require("mithril")),l=e(require("classNames")),n=e(require("../singleComponentBasic")),i=require("../const"),u=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.view=function(){var t=this;return[a.default(".c-kifuPlayer_info",{class:l.default(this.appData.isOpenInfo?"is-active":null)},[a.default(".columns",[a.default(".c-kifuPlayer_info_title",a.default("label.label.c-shogiBan_menu_label.is-main","棋譜情報")),a.default(".c-kifuPlayer_info_close",a.default("span.icon.fa-lg",{onclick:function(){t.appData.isOpenInfo=!1}},a.default("i.fa.fa-times")))]),a.default(".field.c-shogiBan_menu_option",[a.default("label.label.c-shogiBan_menu_label","タイトル"),a.default(".field",a.default(".control",a.default("input.input.is-primary",{type:"text",value:this.appData.title,readonly:this.appData.state!==i.STATE.EDITMOVE,placeholder:"棋譜タイトルを入力",oninput:a.default.withAttr("value",function(e){t.appData.setHeader("title",e)})})))]),a.default(".field.c-shogiBan_menu_option",[a.default(".columns",[a.default(".column",[a.default("label.label.c-shogiBan_menu_label","先手対局者"),a.default(".field",a.default(".control",a.default("input.input.is-primary",{type:"text",value:this.appData.proponent_name,readonly:this.appData.state===i.STATE.VIEW,placeholder:"先手対局者情報なし",oninput:a.default.withAttr("value",function(e){t.appData.setHeader("proponent_name",e)})})))]),a.default(".column",[a.default("label.label.c-shogiBan_menu_label","後手対局者"),a.default(".field",a.default(".control",a.default("input.input.is-primary",{type:"text",value:this.appData.opponent_name,readonly:this.appData.state===i.STATE.VIEW,placeholder:"後手対局者情報なし",oninput:a.default.withAttr("value",function(e){t.appData.setHeader("opponent_name",e)})})))])])]),a.default(".field.c-shogiBan_menu_option",[a.default("label.label.c-shogiBan_menu_label","棋戦名"),a.default(".field",a.default(".control",a.default("input.input.is-primary",{type:"text",value:this.appData.place,readonly:this.appData.state===i.STATE.VIEW,placeholder:"棋戦情報なし",oninput:a.default.withAttr("value",function(e){t.appData.setHeader("place",e)})})))]),a.default(".field.c-shogiBan_menu_option",[a.default("label.label.c-shogiBan_menu_label.c-shogiBan_menu_expandOpton","棋譜詳細"),a.default(".field",a.default(".control",a.default("textarea.textarea.is-primary",{value:this.appData.detail,readonly:this.appData.state===i.STATE.VIEW,placeholder:"棋譜詳細なし",maxlength:140,oninput:a.default.withAttr("value",function(e){t.appData.setHeader("detail",e)})})))])])]},n}(n.default);exports.default=u;
},{"mithril":13,"classNames":133,"../singleComponentBasic":131,"../const":132}],9:[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var e=t(require("mithril")),a=t(require("../appdata")),i=t(require("./shogiBan")),u=t(require("./moveList")),n=t(require("./toolBar")),f=t(require("./editorMenu")),r=t(require("./kifuInfo")),s=function(){function t(){}return t.prototype.oninit=function(){this.appData=new a.default,this.shogiBan=i.default.getInstance(i.default,this.appData),this.moveList=u.default.getInstance(u.default,this.appData),this.toolBar=n.default.getInstance(n.default,this.appData),this.editorMenu=f.default.getInstance(f.default,this.appData),this.kifuInfo=r.default.getInstance(r.default,this.appData)},t.prototype.view=function(){return[e.default(".c-kifuPlayer",[e.default(".c-kifuPlayer_inner",[e.default(".c-kifuPlayer_main",[e.default(".c-shogiBan",[e.default(this.shogiBan),e.default(this.editorMenu),e.default(".c-shogiBan_bg",[e.default(".c-shogiBan_base")])]),e.default(".c-kifuPlayer_inner2",[e.default(this.toolBar)])]),e.default(this.kifuInfo)]),e.default(this.moveList)])]},t}();exports.default=s;
},{"mithril":13,"../appdata":91,"./shogiBan":92,"./moveList":93,"./toolBar":94,"./editorMenu":95,"./kifuInfo":96}],4:[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};exports.__esModule=!0;var t=e(require("mithril"));require("bulma"),require("bulma-switch"),require("bulma-tooltip"),require("../scss/main.scss");var r=e(require("./components/JKFEdit")),u=new r.default;document.addEventListener("DOMContentLoaded",function(){t.default.route(document.body,"/",{"/":u})});
},{"mithril":13,"bulma":14,"bulma-switch":14,"bulma-tooltip":14,"../scss/main.scss":14,"./components/JKFEdit":9}]},{},[4])
//# sourceMappingURL=/JKFEdit/app.f2e0d9ed.map